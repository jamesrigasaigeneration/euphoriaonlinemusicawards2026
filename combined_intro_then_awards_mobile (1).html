<!doctype html>
<html lang="el">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Euphoria Intro → Neon Awards</title>
  <meta name="theme-color" content="#000000" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <style>
    html,body{height:100%; margin:0; background:#000; overflow:hidden;}
    .layer{position:fixed; inset:0; width:100%; height:100%; border:0;}
    #introFrame{z-index:10;}
    #mainFrame{z-index:1; opacity:0; pointer-events:none; transition:opacity .8s ease; background:#070817;}
    body.main-on #mainFrame{opacity:1; pointer-events:auto;}
    body.main-on #introFrame{opacity:0; pointer-events:none; transition:opacity .6s ease;}
    /* special optical effect on transition */
    #fx{position:fixed; inset:0; z-index:20; pointer-events:none; opacity:0;}
    body.fx-on #fx{opacity:1; animation:fxFlash 1.2s ease forwards;}
    @keyframes fxFlash{
      0%{opacity:0; filter:none;}
      10%{opacity:1; filter:contrast(1.35) saturate(1.4) blur(0px);}
      35%{opacity:1; filter:contrast(1.55) saturate(1.8) blur(1px);}
      65%{opacity:.75; filter:contrast(1.2) saturate(1.25) blur(0.5px);}
      100%{opacity:0; filter:none;}
    }
    /* scanlines + slight chromatic split */
    #fx::before{
      content:"";
      position:absolute; inset:-5%;
      background:
        repeating-linear-gradient(0deg, rgba(255,255,255,0.06) 0 1px, transparent 1px 4px),
        radial-gradient(circle at 50% 50%, rgba(255,46,166,.22), transparent 55%),
        radial-gradient(circle at 52% 48%, rgba(0,209,255,.18), transparent 60%);
      mix-blend-mode:overlay;
      transform:translateZ(0);
    }
    #fx::after{
      content:"";
      position:absolute; inset:0;
      background:
        linear-gradient(90deg, rgba(255,46,166,.20), transparent 35%, transparent 65%, rgba(0,209,255,.18));
      mix-blend-mode:screen;
      animation:fxJitter 0.14s steps(2) infinite;
      opacity:.85;
    }
    @keyframes fxJitter{
      0%{transform:translate(0,0) skewX(0deg);}
      50%{transform:translate(2px,-1px) skewX(0.6deg);}
      100%{transform:translate(-2px,1px) skewX(-0.6deg);}
    }
    /* small hint (optional) */
    #hint{
      padding-bottom: env(safe-area-inset-bottom);
      padding-left: env(safe-area-inset-left);
      padding-right: env(safe-area-inset-right);

      position:fixed; left:16px; bottom:14px; z-index:30;
      color:rgba(255,255,255,.55); font: 12px/1.3 system-ui, -apple-system, Segoe UI, Roboto, Arial;
      letter-spacing:.06em; user-select:none; pointer-events:none;
      text-shadow:0 0 12px rgba(0,209,255,.18), 0 0 12px rgba(255,46,166,.14);
      opacity:.0; transition:opacity .4s ease;
    }
    body:not(.main-on) #hint{
      padding-bottom: env(safe-area-inset-bottom);
      padding-left: env(safe-area-inset-left);
      padding-right: env(safe-area-inset-right);
opacity:.9;}
  
    #startOverlay{
      position:fixed; inset:0; z-index:40;
      display:flex; align-items:center; justify-content:center;
      background:rgba(0,0,0,.65);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      padding: max(18px, env(safe-area-inset-top)) max(18px, env(safe-area-inset-right))
               max(18px, env(safe-area-inset-bottom)) max(18px, env(safe-area-inset-left));
    }
    #startOverlay.hidden{ display:none; }
    #startOverlay .startCard{
      width:min(520px, 92vw);
      border-radius:22px;
      padding:18px 18px 16px;
      background:rgba(10,10,18,.72);
      box-shadow: 0 0 30px rgba(0,209,255,.10), 0 0 30px rgba(255,46,166,.08);
      border:1px solid rgba(255,255,255,.10);
    }
    #startOverlay .startTitle{
      font: 700 20px/1.2 system-ui, -apple-system, Segoe UI, Roboto, Arial;
      color:rgba(255,255,255,.92);
      letter-spacing:.02em;
      margin-bottom:8px;
      text-shadow:0 0 16px rgba(0,209,255,.20), 0 0 16px rgba(255,46,166,.14);
    }
    #startOverlay .startSub{
      font: 13px/1.35 system-ui, -apple-system, Segoe UI, Roboto, Arial;
      color:rgba(255,255,255,.70);
      letter-spacing:.02em;
    }

  </style>
</head>
<body>
  <iframe id="introFrame" class="layer" title="Euphoria Intro" allow="autoplay; fullscreen; picture-in-picture" allowfullscreen></iframe>
  <iframe id="mainFrame" class="layer" title="Neon Awards" allow="autoplay; fullscreen; picture-in-picture" allowfullscreen></iframe>
  <div id="fx" aria-hidden="true"></div>
  <div id="hint" aria-hidden="true">Intro… (αυτόματο πέρασμα σε 10s)</div>

  <div id="startOverlay" role="button" aria-label="Tap to start" tabindex="0">
    <div class="startCard">
      <div class="startTitle">Tap to start</div>
      <div class="startSub">Βελτιστοποιημένο για κινητό — ξεκινάει το intro &amp; το timer.</div>
    </div>
  </div>


  <script>
    const INTRO_B64 = "PCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9ImVsIj4KPGhlYWQ+CjxtZXRhIGNoYXJzZXQ9InV0Zi04IiAvPgo8bWV0YSBuYW1lPSJ2aWV3cG9ydCIgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEiIC8+Cjx0aXRsZT5FdXBob3JpYSDigJQgTmVvbiBTbW9vdGggKFB1bHNlICsgR3JhaW4pPC90aXRsZT4KPHN0eWxlPgogIDpyb290ewogICAgLS1iZy1kZWVwOiMwMjAzMGE7CiAgICAtLWJnLWJsdWU6IzA1MGEyMjsKICAgIC0tYmctYmx1ZTI6IzA2MGIxZTsKCiAgICAtLXdoaXRlOiNmZmY7CiAgICAtLW5lb24tY3lhbjojMmJkOWZmOwogICAgLS1uZW9uLXBpbms6I2ZmMmJkNjsKCiAgICAtLWdsYXNzOiByZ2JhKDEyLCAyNCwgNTAsIC4zOCk7CiAgICAtLXN0cm9rZTogcmdiYSg0MSwxODIsMjU1LC41NSk7CgogICAgLyogc3luYyBrbm9icyAqLwogICAgLS1wdWxzZUR1cjogMy42czsgICAgIC8qIGtlZXAgc2FtZSBhcyBsb2dvIG5lb25CcmVhdGggKi8KICAgIC0tcHVsc2VEZWxheTogMS4yczsgICAvKiBtYXRjaGVzIGxvZ28gbmVvbkJyZWF0aCBkZWxheSAqLwogIH0KCiAgKnsgYm94LXNpemluZzpib3JkZXItYm94OyB9CiAgaHRtbCxib2R5eyBoZWlnaHQ6MTAwJTsgfQoKICAvKiA9PT09PSBCQVNFIEJBQ0tHUk9VTkQgKGRhcmsgbmVvbikgPT09PT0gKi8KICBib2R5ewogICAgbWFyZ2luOjA7CiAgICBvdmVyZmxvdzpoaWRkZW47CiAgICBjb2xvcjp2YXIoLS13aGl0ZSk7CiAgICBmb250LWZhbWlseTogc3lzdGVtLXVpLCAtYXBwbGUtc3lzdGVtLCBTZWdvZSBVSSwgUm9ib3RvLCBIZWx2ZXRpY2EsIEFyaWFsLCAiQnJ1c2ggU2NyaXB0IE1UIiwgY3Vyc2l2ZTsKCiAgICBiYWNrZ3JvdW5kOgogICAgICByYWRpYWwtZ3JhZGllbnQoMTIwMHB4IDYwMHB4IGF0IDE4JSAyMiUsIHJnYmEoMjU1LDQzLDIxNCwwLjE4KSwgdHJhbnNwYXJlbnQgNjIlKSwKICAgICAgcmFkaWFsLWdyYWRpZW50KDExMDBweCA2NTBweCBhdCA3OCUgNzIlLCByZ2JhKDQzLDIxNywyNTUsMC4xNiksIHRyYW5zcGFyZW50IDY2JSksCiAgICAgIGxpbmVhci1ncmFkaWVudCgxMzVkZWcsIHZhcigtLWJnLWJsdWUpIDAlLCB2YXIoLS1iZy1kZWVwKSA0NSUsIHZhcigtLWJnLWJsdWUyKSAxMDAlKTsKICB9CgogIC8qID09PT09IFNMT1cgTkVPTiBNT1RJT04gTEFZRVIgKHZlcnkgc2xvdyBkcmlmdCkgPT09PT0gKi8KICAuYmctZHJpZnR7CiAgICBwb3NpdGlvbjpmaXhlZDsKICAgIGluc2V0Oi0yMiU7CiAgICBwb2ludGVyLWV2ZW50czpub25lOwogICAgei1pbmRleDowOwogICAgYmFja2dyb3VuZDoKICAgICAgcmFkaWFsLWdyYWRpZW50KDk4MHB4IDU2MHB4IGF0IDMwJSAzMCUsIHJnYmEoMjU1LDQzLDIxNCwwLjIwKSwgdHJhbnNwYXJlbnQgNjAlKSwKICAgICAgcmFkaWFsLWdyYWRpZW50KDkyMHB4IDU2MHB4IGF0IDcwJSA3MCUsIHJnYmEoNDMsMjE3LDI1NSwwLjE4KSwgdHJhbnNwYXJlbnQgNjIlKTsKICAgIGZpbHRlcjogYmx1cigyMHB4KSBzYXR1cmF0ZSgxLjIpOwogICAgb3BhY2l0eTouODU7CiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZTNkKDAsMCwwKTsKICAgIGFuaW1hdGlvbjogYmdEcmlmdCAyMnMgZWFzZS1pbi1vdXQgaW5maW5pdGUgYWx0ZXJuYXRlOwogICAgbWl4LWJsZW5kLW1vZGU6IHNjcmVlbjsKICAgIHdpbGwtY2hhbmdlOiB0cmFuc2Zvcm0sIG9wYWNpdHk7CiAgfQoKICBAa2V5ZnJhbWVzIGJnRHJpZnR7CiAgICAwJSAgIHsgdHJhbnNmb3JtOiB0cmFuc2xhdGUoLTIuNSUsIC0xLjUlKSBzY2FsZSgxLjAyKTsgfQogICAgNTAlICB7IHRyYW5zZm9ybTogdHJhbnNsYXRlKDIuNSUsICAxLjIlKSBzY2FsZSgxLjA1KTsgfQogICAgMTAwJSB7IHRyYW5zZm9ybTogdHJhbnNsYXRlKC0xLjIlLCAyLjIlKSBzY2FsZSgxLjAzKTsgfQogIH0KCiAgLyogPT09PT0gUFVMU0UgTEFZRVIgKHN5bmNlZCB0byBsb2dvKSA9PT09PSAqLwogIC5iZy1wdWxzZXsKICAgIHBvc2l0aW9uOmZpeGVkOwogICAgaW5zZXQ6MDsKICAgIHBvaW50ZXItZXZlbnRzOm5vbmU7CiAgICB6LWluZGV4OjE7CiAgICBvcGFjaXR5OjA7CiAgICB0cmFuc2l0aW9uOiBvcGFjaXR5IC42cyBlYXNlOwogICAgbWl4LWJsZW5kLW1vZGU6IHNjcmVlbjsKICB9CgogIC8qIG9ubHkgc3RhcnQgcHVsc2luZyBvbmNlIGxvZ28gaXMgInJlYWR5IiAqLwogIGJvZHkubG9nby1vbiAuYmctcHVsc2V7CiAgICBvcGFjaXR5OjE7CiAgICBhbmltYXRpb246IGJnUHVsc2UgdmFyKC0tcHVsc2VEdXIpIGVhc2UtaW4tb3V0IGluZmluaXRlIHZhcigtLXB1bHNlRGVsYXkpOwogIH0KCiAgQGtleWZyYW1lcyBiZ1B1bHNlewogICAgMCUsMTAwJXsKICAgICAgZmlsdGVyOiBibHVyKDBweCkgc2F0dXJhdGUoMS4wNSk7CiAgICAgIG9wYWNpdHk6LjU1OwogICAgfQogICAgNTAlewogICAgICBmaWx0ZXI6IGJsdXIoMHB4KSBzYXR1cmF0ZSgxLjI1KTsKICAgICAgb3BhY2l0eTouODU7CiAgICB9CiAgfQoKICAuYmctcHVsc2U6OmJlZm9yZXsKICAgIGNvbnRlbnQ6IiI7CiAgICBwb3NpdGlvbjphYnNvbHV0ZTsKICAgIGluc2V0Oi0xMCU7CiAgICBiYWNrZ3JvdW5kOgogICAgICByYWRpYWwtZ3JhZGllbnQoOTAwcHggNTIwcHggYXQgNTAlIDQ1JSwgcmdiYSgyNTUsNDMsMjE0LDAuMTEpLCB0cmFuc3BhcmVudCA2OCUpLAogICAgICByYWRpYWwtZ3JhZGllbnQoODYwcHggNTIwcHggYXQgNTIlIDUwJSwgcmdiYSg0MywyMTcsMjU1LDAuMTApLCB0cmFuc3BhcmVudCA3MCUpOwogICAgZmlsdGVyOiBibHVyKDE4cHgpOwogIH0KCiAgLyogPT09PT0gQ0lORU1BVElDIE5PSVNFIC8gR1JBSU4gPT09PT0gKi8KICAuZ3JhaW57CiAgICBwb3NpdGlvbjpmaXhlZDsKICAgIGluc2V0Oi0xNSU7CiAgICBwb2ludGVyLWV2ZW50czpub25lOwogICAgei1pbmRleDozOwogICAgb3BhY2l0eTouMzI7CiAgICBtaXgtYmxlbmQtbW9kZTogb3ZlcmxheTsKICAgIGJhY2tncm91bmQ6CiAgICAgIHJlcGVhdGluZy1saW5lYXItZ3JhZGllbnQoMGRlZywgcmdiYSgyNTUsMjU1LDI1NSwwLjAyOCkgMCAxcHgsIHRyYW5zcGFyZW50IDFweCAzcHgpLAogICAgICByZXBlYXRpbmctbGluZWFyLWdyYWRpZW50KDkwZGVnLCByZ2JhKDI1NSwyNTUsMjU1LDAuMDIwKSAwIDFweCwgdHJhbnNwYXJlbnQgMXB4IDRweCksCiAgICAgIHJhZGlhbC1ncmFkaWVudChjaXJjbGUgYXQgNTAlIDUwJSwgcmdiYSgyNTUsMjU1LDI1NSwwLjAzKSwgdHJhbnNwYXJlbnQgNzAlKTsKICAgIGZpbHRlcjogY29udHJhc3QoMTE1JSkgYnJpZ2h0bmVzcygxMDUlKTsKICAgIGFuaW1hdGlvbjogZ3JhaW5Nb3ZlIDZzIHN0ZXBzKDgpIGluZmluaXRlOwogICAgd2lsbC1jaGFuZ2U6IHRyYW5zZm9ybTsKICB9CgogIEBrZXlmcmFtZXMgZ3JhaW5Nb3ZlewogICAgMCUgICB7IHRyYW5zZm9ybTogdHJhbnNsYXRlKDAsMCkgcm90YXRlKDAuMDFkZWcpOyB9CiAgICAxMCUgIHsgdHJhbnNmb3JtOiB0cmFuc2xhdGUoLTIlLCAxJSkgcm90YXRlKDAuMDFkZWcpOyB9CiAgICAyMCUgIHsgdHJhbnNmb3JtOiB0cmFuc2xhdGUoLTQlLCAtMiUpIHJvdGF0ZSgwLjAxZGVnKTsgfQogICAgMzAlICB7IHRyYW5zZm9ybTogdHJhbnNsYXRlKDMlLCAyJSkgcm90YXRlKDAuMDFkZWcpOyB9CiAgICA0MCUgIHsgdHJhbnNmb3JtOiB0cmFuc2xhdGUoMSUsIC0zJSkgcm90YXRlKDAuMDFkZWcpOyB9CiAgICA1MCUgIHsgdHJhbnNmb3JtOiB0cmFuc2xhdGUoLTMlLCAzJSkgcm90YXRlKDAuMDFkZWcpOyB9CiAgICA2MCUgIHsgdHJhbnNmb3JtOiB0cmFuc2xhdGUoNCUsIDElKSByb3RhdGUoMC4wMWRlZyk7IH0KICAgIDcwJSAgeyB0cmFuc2Zvcm06IHRyYW5zbGF0ZSgyJSwgLTIlKSByb3RhdGUoMC4wMWRlZyk7IH0KICAgIDgwJSAgeyB0cmFuc2Zvcm06IHRyYW5zbGF0ZSgtMiUsIDIlKSByb3RhdGUoMC4wMWRlZyk7IH0KICAgIDkwJSAgeyB0cmFuc2Zvcm06IHRyYW5zbGF0ZSgzJSwgLTElKSByb3RhdGUoMC4wMWRlZyk7IH0KICAgIDEwMCUgeyB0cmFuc2Zvcm06IHRyYW5zbGF0ZSgwLDApIHJvdGF0ZSgwLjAxZGVnKTsgfQogIH0KCiAgLyogPT09PT0gSU5UUk8gUE9QVVAgPT09PT0gKi8KICAuaW50cm8tbGF5ZXJ7CiAgICBwb3NpdGlvbjpmaXhlZDsgaW5zZXQ6MDsgei1pbmRleDoxMDsKICAgIGRpc3BsYXk6Z3JpZDsgcGxhY2UtaXRlbXM6Y2VudGVyOwogICAgYmFja2dyb3VuZDoKICAgICAgcmFkaWFsLWdyYWRpZW50KDEyMDBweCA4MDBweCBhdCA1MCUgNTAlLCByZ2JhKDAsMCwwLC40OCksIHRyYW5zcGFyZW50IDcwJSksCiAgICAgIGxpbmVhci1ncmFkaWVudCgxMzVkZWcsIHJnYmEoNCwxMCwzMiwuOTApIDAlLCByZ2JhKDAsMCwwLC45NSkgMTAwJSk7CiAgICBiYWNrZHJvcC1maWx0ZXI6IGJsdXIoNnB4KSBzYXR1cmF0ZSgxLjA1KTsKICAgIHRyYW5zaXRpb246IG9wYWNpdHkgLjdzIGVhc2UsIHRyYW5zZm9ybSAuN3MgY3ViaWMtYmV6aWVyKC4yLC44LC4yLDEpLCBmaWx0ZXIgLjdzIGVhc2U7CiAgfQoKICAuaW50cm8tY2FyZHsKICAgIHdpZHRoOm1pbig4NnZ3LDUyMHB4KTsKICAgIGJvcmRlci1yYWRpdXM6MjBweDsKICAgIHBhZGRpbmc6MjhweCAyNHB4IDIycHg7CiAgICBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoMTgwZGVnLCB2YXIoLS1nbGFzcyksIHJnYmEoMCwwLDAsLjE4KSk7CiAgICBib3JkZXI6MXB4IHNvbGlkIHJnYmEoNDEsMTgyLDI1NSwuNTUpOwogICAgYm94LXNoYWRvdzoKICAgICAgMCAwIDI0cHggcmdiYSg0MSwxODIsMjU1LC4xOCksCiAgICAgIDAgMCA4MHB4IHJnYmEoMjU1LDQzLDIxNCwuMTApLAogICAgICAwIDAgMTMwcHggcmdiYSg0MywyMTcsMjU1LC4wOCk7CiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoMTZweCkgc2NhbGUoLjk4KTsKICAgIG9wYWNpdHk6MDsKICAgIGZpbHRlcjogYmx1cig4cHgpOwogICAgdHJhbnNpdGlvbjoKICAgICAgb3BhY2l0eSAuNjVzIGVhc2UsCiAgICAgIHRyYW5zZm9ybSAuNzVzIGN1YmljLWJlemllciguMiwuOCwuMiwxKSwKICAgICAgZmlsdGVyIC43NXMgZWFzZTsKICAgIHdpbGwtY2hhbmdlOiB0cmFuc2Zvcm0sIG9wYWNpdHksIGZpbHRlcjsKICB9CiAgLmludHJvLWNhcmQuc2hvd3sKICAgIG9wYWNpdHk6MTsKICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgwKSBzY2FsZSgxKTsKICAgIGZpbHRlcjogYmx1cigwKTsKICB9CgogIC5oZXJvLW5hbWV7CiAgICBtYXJnaW46NnB4IDAgMnB4OwogICAgdGV4dC1hbGlnbjpjZW50ZXI7CiAgICBmb250LXNpemU6Y2xhbXAoMThweCw0LjZ2dyw0MHB4KTsKICAgIGZvbnQtd2VpZ2h0OjY1MDsKICAgIGxldHRlci1zcGFjaW5nOi0uMDJlbTsKICAgIGNvbG9yOnJnYmEoMjU1LDI1NSwyNTUsLjkyKTsKICAgIHRleHQtc2hhZG93OiAwIDAgMTBweCByZ2JhKDI1NSwyNTUsMjU1LC4xOCk7CiAgfQoKICAuc3VibGluZXsKICAgIHRleHQtYWxpZ246Y2VudGVyOwogICAgbWFyZ2luOjhweCAwIDE4cHg7CiAgICBmb250LWZhbWlseToiTW9udHNlcnJhdCIsIHN5c3RlbS11aSwgQXJpYWwsIHNhbnMtc2VyaWY7CiAgICBmb250LXdlaWdodDo4MDA7CiAgICBsZXR0ZXItc3BhY2luZzoxLjFlbTsKICAgIGZvbnQtc2l6ZTpjbGFtcCgxMHB4LDJ2dywxNHB4KTsKICAgIGNvbG9yOnJnYmEoMjU1LDI1NSwyNTUsLjUwKTsKICAgIHRleHQtdHJhbnNmb3JtOnVwcGVyY2FzZTsKICB9CgogIC5jdGF7IGRpc3BsYXk6ZmxleDsganVzdGlmeS1jb250ZW50OmNlbnRlcjsgfQogIC5jdGEgYnV0dG9uewogICAgY3Vyc29yOnBvaW50ZXI7CiAgICBib3JkZXI6bm9uZTsKICAgIHBhZGRpbmc6MTJweCAyMnB4OwogICAgYm9yZGVyLXJhZGl1czoxNnB4OwogICAgZm9udC13ZWlnaHQ6ODUwOwogICAgbGV0dGVyLXNwYWNpbmc6LjMyZW07CiAgICBmb250LWZhbWlseToiTW9udHNlcnJhdCIsIHN5c3RlbS11aSwgQXJpYWwsIHNhbnMtc2VyaWY7CiAgICB0ZXh0LXRyYW5zZm9ybTp1cHBlcmNhc2U7CiAgICBjb2xvcjp2YXIoLS13aGl0ZSk7CiAgICBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoOTBkZWcsIHZhcigtLW5lb24tcGluayksIHZhcigtLW5lb24tY3lhbikpOwogICAgYm94LXNoYWRvdzoKICAgICAgMCAwIDEycHggcmdiYSgyNTUsNDMsMjE0LC42MCksCiAgICAgIDAgMCAyNnB4IHJnYmEoNDMsMjE3LDI1NSwuNDUpLAogICAgICAwIDAgNjBweCByZ2JhKDQzLDIxNywyNTUsLjI1KTsKICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgwKSBzY2FsZSgxKTsKICAgIHRyYW5zaXRpb246IHRyYW5zZm9ybSAuMjJzIGVhc2UsIGZpbHRlciAuMjJzIGVhc2UsIGJveC1zaGFkb3cgLjIycyBlYXNlOwogICAgcG9zaXRpb246cmVsYXRpdmU7CiAgICBpc29sYXRpb246aXNvbGF0ZTsKICB9CiAgLmN0YSBidXR0b246OmJlZm9yZXsKICAgIGNvbnRlbnQ6IiI7CiAgICBwb3NpdGlvbjphYnNvbHV0ZTsKICAgIGluc2V0Oi0ycHg7CiAgICBib3JkZXItcmFkaXVzOjE4cHg7CiAgICBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoOTBkZWcsIHJnYmEoMjU1LDQzLDIxNCwuODUpLCByZ2JhKDQzLDIxNywyNTUsLjc1KSk7CiAgICBmaWx0ZXI6IGJsdXIoMTJweCk7CiAgICBvcGFjaXR5Oi41NTsKICAgIHotaW5kZXg6LTE7CiAgICB0cmFuc2l0aW9uOiBvcGFjaXR5IC4yMnMgZWFzZSwgZmlsdGVyIC4yMnMgZWFzZTsKICB9CiAgLmN0YSBidXR0b246aG92ZXJ7CiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTJweCkgc2NhbGUoMS4wMSk7CiAgICBmaWx0ZXI6IGJyaWdodG5lc3MoMS4xKTsKICAgIGJveC1zaGFkb3c6CiAgICAgIDAgMCAxOHB4IHJnYmEoMjU1LDQzLDIxNCwuODApLAogICAgICAwIDAgMzhweCByZ2JhKDQzLDIxNywyNTUsLjU1KSwKICAgICAgMCAwIDkwcHggcmdiYSg0MywyMTcsMjU1LC4zNSk7CiAgfQogIC5jdGEgYnV0dG9uOmhvdmVyOjpiZWZvcmV7IG9wYWNpdHk6Ljg7IGZpbHRlcjogYmx1cigxNHB4KTsgfQogIC5jdGEgYnV0dG9uOmFjdGl2ZXsgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKDApIHNjYWxlKC45OSk7IH0KCiAgLmludHJvLWxheWVyLmV4aXR7CiAgICBvcGFjaXR5OjA7CiAgICB0cmFuc2Zvcm06IHNjYWxlKDEuMDIpOwogICAgZmlsdGVyOiBibHVyKDEwcHgpIGJyaWdodG5lc3MoMS4xNSk7CiAgICBwb2ludGVyLWV2ZW50czpub25lOwogIH0KCiAgLyogPT09PT0gTUFJTiBTVEFHRSA9PT09PSAqLwogIC5zdGFnZXsKICAgIHBvc2l0aW9uOmZpeGVkOyBpbnNldDowOwogICAgZGlzcGxheTpncmlkOyBwbGFjZS1pdGVtczpjZW50ZXI7CiAgICB6LWluZGV4OjI7CiAgICBwYWRkaW5nOiA2dmggNHZ3OwogICAgb3BhY2l0eTowOwogICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKDhweCk7CiAgICBmaWx0ZXI6IGJsdXIoOHB4KTsKICAgIHRyYW5zaXRpb246CiAgICAgIG9wYWNpdHkgLjc1cyBlYXNlLAogICAgICB0cmFuc2Zvcm0gLjg1cyBjdWJpYy1iZXppZXIoLjIsLjgsLjIsMSksCiAgICAgIGZpbHRlciAuODVzIGVhc2UsCiAgICAgIHBhZGRpbmcgLjg1cyBlYXNlOwogICAgd2lsbC1jaGFuZ2U6IHRyYW5zZm9ybSwgb3BhY2l0eSwgZmlsdGVyLCBwYWRkaW5nOwogIH0KICAuc3RhZ2UuYWN0aXZlewogICAgb3BhY2l0eToxOwogICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKDApOwogICAgZmlsdGVyOiBibHVyKDApOwogIH0KCiAgLmxvZ297CiAgICBwb3NpdGlvbjpyZWxhdGl2ZTsKICAgIHRleHQtYWxpZ246Y2VudGVyOwogICAgZmlsdGVyOiBkcm9wLXNoYWRvdygwIDAgMjZweCByZ2JhKDI1NSw0MywyMTQsLjU1KSk7CiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVooMCk7CiAgICB3aWxsLWNoYW5nZTogdHJhbnNmb3JtOwogIH0KCiAgLnRpdGxlewogICAgbWFyZ2luOjA7CiAgICBmb250LXNpemU6IGNsYW1wKDQ4cHgsIDIwdncsIDgwMHB4KTsKICAgIGxpbmUtaGVpZ2h0Oi44ODsKICAgIHdoaXRlLXNwYWNlOm5vd3JhcDsKICAgIGZvbnQtZmFtaWx5OiJCcnVzaCBTY3JpcHQgTVQiLCJCcnVzaCBTY3JpcHQgU3RkIixjdXJzaXZlOwogICAgZm9udC13ZWlnaHQ6NjAwOwogICAgbGV0dGVyLXNwYWNpbmc6LS4wM2VtOwogICAgY29sb3I6dmFyKC0td2hpdGUpOwogICAgLXdlYmtpdC10ZXh0LXN0cm9rZTouNHB4IHJnYmEoMjU1LDI1NSwyNTUsLjUpOwogICAgdGV4dC1zaGFkb3c6CiAgICAgIDAgMCAxOHB4IHJnYmEoMjU1LDQzLDIxNCwuODUpLAogICAgICAwIDAgNDBweCByZ2JhKDQzLDIxNywyNTUsLjU1KSwKICAgICAgMCAwIDRweCByZ2JhKDI1NSwyNTUsMjU1LC45NSk7CiAgICBvcGFjaXR5OjA7CiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoMThweCkgc2NhbGUoLjk4NSk7CiAgICB0cmFuc2l0aW9uOiBmb250LXNpemUgLjlzIGVhc2UsIGxldHRlci1zcGFjaW5nIC45cyBlYXNlOwogICAgd2lsbC1jaGFuZ2U6IHRyYW5zZm9ybSwgb3BhY2l0eTsKICB9CgogIEBrZXlmcmFtZXMgbmVvbkJyZWF0aHsKICAgIDAlLDEwMCV7CiAgICAgIHRleHQtc2hhZG93OgogICAgICAgIDAgMCAxOHB4IHJnYmEoMjU1LDQzLDIxNCwuODUpLAogICAgICAgIDAgMCA0MHB4IHJnYmEoNDMsMjE3LDI1NSwuNTUpLAogICAgICAgIDAgMCA0cHggcmdiYSgyNTUsMjU1LDI1NSwxKTsKICAgICAgZmlsdGVyOiBzYXR1cmF0ZSgxLjA1KTsKICAgIH0KICAgIDUwJXsKICAgICAgdGV4dC1zaGFkb3c6CiAgICAgICAgMCAwIDMycHggcmdiYSgyNTUsNDMsMjE0LDEpLAogICAgICAgIDAgMCA3OHB4IHJnYmEoNDMsMjE3LDI1NSwuNzUpLAogICAgICAgIDAgMCA1cHggcmdiYSgyNTUsMjU1LDI1NSwxKTsKICAgICAgZmlsdGVyOiBzYXR1cmF0ZSgxLjIpOwogICAgfQogIH0KICAudGl0bGUucmVhZHl7CiAgICBvcGFjaXR5OjE7CiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoMCkgc2NhbGUoMSk7CiAgICBhbmltYXRpb246IG5lb25CcmVhdGggdmFyKC0tcHVsc2VEdXIpIGVhc2UtaW4tb3V0IGluZmluaXRlIHZhcigtLXB1bHNlRGVsYXkpOwogIH0KCiAgLnRpdGxlIC5sZXR0ZXJ7CiAgICBkaXNwbGF5OmlubGluZS1ibG9jazsKICAgIG9wYWNpdHk6MDsKICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgyNnB4KSBzY2FsZSguOTYpIHNrZXdZKDEuNWRlZyk7CiAgICBmaWx0ZXI6IGJsdXIoN3B4KTsKICAgIHdpbGwtY2hhbmdlOiB0cmFuc2Zvcm0sIG9wYWNpdHksIGZpbHRlcjsKICB9CiAgLnRpdGxlIC5sZXR0ZXIuc2hvd3sKICAgIG9wYWNpdHk6MTsKICAgIHRyYW5zZm9ybTpub25lOwogICAgZmlsdGVyOiBibHVyKDApOwogICAgdHJhbnNpdGlvbjoKICAgICAgb3BhY2l0eSAuNjJzIGN1YmljLWJlemllciguMjIsLjYxLC4zNiwxKSwKICAgICAgdHJhbnNmb3JtIC43NHMgY3ViaWMtYmV6aWVyKC4yMiwuNjEsLjM2LDEpLAogICAgICBmaWx0ZXIgLjc0cyBlYXNlOwogIH0KICBAa2V5ZnJhbWVzIGZsb2F0eXsKICAgIDAleyB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoMCk7IH0KICAgIDUwJXsgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC0ycHgpOyB9CiAgICAxMDAleyB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoMCk7IH0KICB9CiAgLnRpdGxlIC5sZXR0ZXIuZmxvd3sgYW5pbWF0aW9uOiBmbG9hdHkgMy44cyBlYXNlLWluLW91dCBpbmZpbml0ZTsgfQoKICAuc3VidGl0bGV7CiAgICBmb250LWZhbWlseToiTW9udHNlcnJhdCIsIlNlZ29lIFVJIixBcmlhbCxzYW5zLXNlcmlmOwogICAgZm9udC13ZWlnaHQ6OTAwOwogICAgbGV0dGVyLXNwYWNpbmc6M3B4OwogICAgbWFyZ2luLXRvcDowOwogICAgcG9zaXRpb246IHJlbGF0aXZlOwogICAgdG9wOi0zNnB4OyAvKiBPTkxZIHN1YnRpdGxlIG1vdmVzIHVwICovCiAgICBmb250LXNpemU6Y2xhbXAoMTZweCwzdncsNDhweCk7CiAgICB0ZXh0LXNoYWRvdzoKICAgICAgMCAwIDEwcHggcmdiYSgyNTUsNDMsMjE0LC4zNSksCiAgICAgIDAgMCAxNHB4IHJnYmEoMjU1LDI1NSwyNTUsLjM1KSwKICAgICAgMCAwIDMwcHggcmdiYSg0MywyMTcsMjU1LC42NSk7CiAgICBvcGFjaXR5OjA7CiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoMTJweCk7CiAgICB0cmFuc2l0aW9uOgogICAgICBvcGFjaXR5IC45NXMgZWFzZSwKICAgICAgdHJhbnNmb3JtIDFzIGVhc2UsCiAgICAgIHRvcCAuODVzIGVhc2UsCiAgICAgIGZvbnQtc2l6ZSAuOXMgZWFzZSwKICAgICAgbGV0dGVyLXNwYWNpbmcgLjlzIGVhc2U7Cn0KICAuc3VidGl0bGUuc2hvd3sgb3BhY2l0eToxOyB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoMCk7IH0KCiAgLyogPT09PT0gQ09NUEFDVCBTVEFURSA9PT09PSAqLwogIC5zdGFnZS5jb21wYWN0ewogICAgYWxpZ24taXRlbXM6Y2VudGVyOwogICAganVzdGlmeS1pdGVtczpjZW50ZXI7CiAgICBwYWRkaW5nLXRvcDogMDsKICAgIHBhZGRpbmctbGVmdDogNHZ3OwogICAgcGFkZGluZy1yaWdodDogNHZ3Owp9CiAgLnRpdGxlLmNvbXBhY3R7CiAgZm9udC1zaXplOiBpbmhlcml0OwogIGxldHRlci1zcGFjaW5nOiBpbmhlcml0Owp9CiAgLnN1YnRpdGxlLmNvbXBhY3R7CiAgdG9wOi0xNHB4OwogIGZvbnQtc2l6ZTogaW5oZXJpdDsKICBsZXR0ZXItc3BhY2luZzogaW5oZXJpdDsKfQoKICAubG9nby5jb21wYWN0TGlmdHsKICAgIGFuaW1hdGlvbjogbGlmdEdsb3cgLjg1cyBjdWJpYy1iZXppZXIoLjIsLjgsLjIsMSkgYm90aDsKICB9CiAgQGtleWZyYW1lcyBsaWZ0R2xvd3sKICAgIDAleyBmaWx0ZXI6IGRyb3Atc2hhZG93KDAgMCAyNnB4IHJnYmEoMjU1LDQzLDIxNCwuNTUpKTsgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKDApIHNjYWxlKDEpOyB9CiAgICA2MCV7IGZpbHRlcjogZHJvcC1zaGFkb3coMCAwIDQ0cHggcmdiYSgyNTUsNDMsMjE0LC43MikpIGRyb3Atc2hhZG93KDAgMCAzNHB4IHJnYmEoNDMsMjE3LDI1NSwuNDUpKTsgfQogICAgMTAwJXsgZmlsdGVyOiBkcm9wLXNoYWRvdygwIDAgMzBweCByZ2JhKDI1NSw0MywyMTQsLjU1KSkgZHJvcC1zaGFkb3coMCAwIDIwcHggcmdiYSg0MywyMTcsMjU1LC4zMikpOyB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTJweCkgc2NhbGUoMSk7IH0KICB9CgogIC8qIGFjY2Vzc2liaWxpdHkgKi8KICBAbWVkaWEgKHByZWZlcnMtcmVkdWNlZC1tb3Rpb246IHJlZHVjZSl7CiAgICAqeyBhbmltYXRpb246bm9uZSAhaW1wb3J0YW50OyB0cmFuc2l0aW9uOm5vbmUgIWltcG9ydGFudDsgfQogICAgLmJnLWRyaWZ0LCAuZ3JhaW57IGFuaW1hdGlvbjpub25lICFpbXBvcnRhbnQ7IH0KICAgIC5iZy1wdWxzZXsgb3BhY2l0eTowICFpbXBvcnRhbnQ7IH0KICB9CgogIC8qID09PT09IElNUEFDVCBMSU5FUyBCVVJTVCAob24gSU5TRVJUKSA9PT09PSAqLwogICNidXJzdENhbnZhc3sKICAgIHBvc2l0aW9uOmZpeGVkOwogICAgaW5zZXQ6MDsKICAgIHdpZHRoOjEwMHZ3OwogICAgaGVpZ2h0OjEwMHZoOwogICAgei1pbmRleDogMTsKICAgIHBvaW50ZXItZXZlbnRzOm5vbmU7CiAgICBvcGFjaXR5OjA7CiAgICB0cmFuc2l0aW9uOiBvcGFjaXR5IC4yNXMgZWFzZTsKICB9CiAgYm9keS5idXJzdC1vbiAjYnVyc3RDYW52YXN7IG9wYWNpdHk6MTsgfQoKPC9zdHlsZT4KPC9oZWFkPgo8Ym9keT4KCiAgPCEtLSBiYWNrZ3JvdW5kIGxheWVycyAtLT4KICA8ZGl2IGNsYXNzPSJiZy1kcmlmdCIgYXJpYS1oaWRkZW49InRydWUiPjwvZGl2PgogIDxkaXYgY2xhc3M9ImJnLXB1bHNlIiBhcmlhLWhpZGRlbj0idHJ1ZSI+PC9kaXY+CiAgPGRpdiBjbGFzcz0iZ3JhaW4iIGFyaWEtaGlkZGVuPSJ0cnVlIj48L2Rpdj4KICA8Y2FudmFzIGlkPSJidXJzdENhbnZhcyIgYXJpYS1oaWRkZW49InRydWUiPjwvY2FudmFzPgoKCiAgPCEtLSBJTlRSTyAtLT4KICA8ZGl2IGNsYXNzPSJpbnRyby1sYXllciIgaWQ9ImludHJvIj4KICAgIDxkaXYgY2xhc3M9ImludHJvLWNhcmQiIGlkPSJpbnRyb0NhcmQiPgogICAgICA8aDIgY2xhc3M9Imhlcm8tbmFtZSI+SkFNRVMgUklHQVM8L2gyPgogICAgICA8ZGl2IGNsYXNzPSJzdWJsaW5lIj5QUkVTRU5UUzwvZGl2PgogICAgICA8ZGl2IGNsYXNzPSJjdGEiPjxidXR0b24gaWQ9ImdvQnRuIj5JTlNFUlQ8L2J1dHRvbj48L2Rpdj4KICAgIDwvZGl2PgogIDwvZGl2PgoKICA8IS0tIE1BSU4gLS0+CiAgPGRpdiBjbGFzcz0ic3RhZ2UiIGlkPSJzdGFnZSIgYXJpYS1oaWRkZW49InRydWUiPgogICAgPGRpdiBjbGFzcz0ibG9nbyIgaWQ9ImxvZ28iPgogICAgICA8aDEgY2xhc3M9InRpdGxlIiBpZD0idGl0bGUiPkV1cGhvcmlhPC9oMT4KICAgICAgPGRpdiBjbGFzcz0ic3VidGl0bGUiIGlkPSJzdWJ0aXRsZSI+T05MSU5FIE1VU0lDIEFXQVJEUyAyMDI2PC9kaXY+CiAgICA8L2Rpdj4KICA8L2Rpdj4KCjxzY3JpcHQ+CigoKSA9PiB7CiAgY29uc3QgaW50cm8gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW50cm8nKTsKICBjb25zdCBjYXJkICA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbnRyb0NhcmQnKTsKICBjb25zdCBnb0J0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdnb0J0bicpOwoKICBjb25zdCBzdGFnZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdGFnZScpOwogIGNvbnN0IGxvZ28gID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvZ28nKTsKICBjb25zdCB0aXRsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0aXRsZScpOwogIGNvbnN0IHN1YnRpdGxlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N1YnRpdGxlJyk7CgogIC8vIHNob3cgcG9wdXAgYWZ0ZXIgMnMKICBzZXRUaW1lb3V0KCgpID0+IGNhcmQuY2xhc3NMaXN0LmFkZCgnc2hvdycpLCAyMDAwKTsKCiAgZnVuY3Rpb24gbGF1bmNoTWFpbigpewogICAgCiAgICBzdGFydEJ1cnN0KCk7CmdvQnRuLmRpc2FibGVkID0gdHJ1ZTsKICAgIGludHJvLmNsYXNzTGlzdC5hZGQoJ2V4aXQnKTsKCiAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgaW50cm8uc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgc3RhZ2UuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7CiAgICAgIHN0YWdlLnNldEF0dHJpYnV0ZSgnYXJpYS1oaWRkZW4nLCAnZmFsc2UnKTsKICAgICAgc3RhcnRMb2dvKCk7CgogICAgICAvLyBjb21wYWN0IG1vZGUgZGlzYWJsZWQg4oCTIGxvZ28gc2l6ZSBsb2NrZWQKCiAgICB9LCA2NTApOwogIH0KICBnb0J0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGxhdW5jaE1haW4pOwogIC8vIEFVVE8tU1RBUlQgKGZvciBjb21iaW5lZCBpbnRybykKICBzZXRUaW1lb3V0KCgpID0+IHsgdHJ5eyBpZihnb0J0biAmJiAhZ29CdG4uZGlzYWJsZWQpIGxhdW5jaE1haW4oKTsgfWNhdGNoKGUpe30gfSwgMjQwMCk7CgoKICAKICAvKiA9PT09PSAxMDAgTElORVMgQlVSU1QgKHNwYXduIGF0IGNlbnRlciwgYm91bmNlL3JlZmxlY3Qgb24gZWRnZXMpID09PT09ICovCiAgY29uc3QgYnVyc3RDYW52YXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnVyc3RDYW52YXMnKTsKICBjb25zdCBiY3R4ID0gYnVyc3RDYW52YXMuZ2V0Q29udGV4dCgnMmQnLCB7IGFscGhhOiB0cnVlIH0pOwoKICBsZXQgYnVyc3RSdW5uaW5nID0gZmFsc2U7CiAgbGV0IGJ1cnN0UGFydHMgPSBbXTsKICBsZXQgYnVyc3RSQUYgPSAwOwogIGxldCBidXJzdFN0YXJ0VCA9IDA7CgogIGZ1bmN0aW9uIHJlc2l6ZUJ1cnN0KCl7CiAgICBjb25zdCBkcHIgPSBNYXRoLm1heCgxLCBNYXRoLm1pbigyLCB3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbyB8fCAxKSk7CiAgICBidXJzdENhbnZhcy53aWR0aCAgPSBNYXRoLmZsb29yKHdpbmRvdy5pbm5lcldpZHRoICAqIGRwcik7CiAgICBidXJzdENhbnZhcy5oZWlnaHQgPSBNYXRoLmZsb29yKHdpbmRvdy5pbm5lckhlaWdodCAqIGRwcik7CiAgICBidXJzdENhbnZhcy5zdHlsZS53aWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoICsgJ3B4JzsKICAgIGJ1cnN0Q2FudmFzLnN0eWxlLmhlaWdodCA9IHdpbmRvdy5pbm5lckhlaWdodCArICdweCc7CiAgICBiY3R4LnNldFRyYW5zZm9ybShkcHIsIDAsIDAsIGRwciwgMCwgMCk7CiAgfQogIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCByZXNpemVCdXJzdCwgeyBwYXNzaXZlOnRydWUgfSk7CiAgcmVzaXplQnVyc3QoKTsKCiAgZnVuY3Rpb24gcmFuZChtaW4sIG1heCl7IHJldHVybiBtaW4gKyBNYXRoLnJhbmRvbSgpICogKG1heCAtIG1pbik7IH0KCiAgZnVuY3Rpb24gbWFrZVBhcnQoKXsKICAgIGNvbnN0IGN4ID0gd2luZG93LmlubmVyV2lkdGggKiAwLjU7CiAgICBjb25zdCBjeSA9IHdpbmRvdy5pbm5lckhlaWdodCAqIDAuNTsKCiAgICAvLyByYW5kb20gZGlyZWN0aW9uIGZyb20gY2VudGVyCiAgICBjb25zdCBhbmcgPSByYW5kKDAsIE1hdGguUEkgKiAyKTsKICAgIGNvbnN0IHNwZWVkID0gcmFuZCg1MjAsIDk4MCk7IC8vIHB4L3NlYwogICAgY29uc3QgdnggPSBNYXRoLmNvcyhhbmcpICogc3BlZWQ7CiAgICBjb25zdCB2eSA9IE1hdGguc2luKGFuZykgKiBzcGVlZDsKCiAgICByZXR1cm4gewogICAgICB4OiBjeCwgeTogY3ksCiAgICAgIHZ4LCB2eSwKICAgICAgbGVuOiByYW5kKDE4LCA1NiksCiAgICAgIHc6IHJhbmQoMS4wLCAyLjQpLAogICAgICBnbG93OiByYW5kKDAuMTgsIDAuNDIpLAogICAgICBhbHBoYTogMSwKICAgICAgaHVlTWl4OiBNYXRoLnJhbmRvbSgpIDwgMC41ID8gJ3BpbmsnIDogJ2N5YW4nCiAgICB9OwogIH0KCiAgZnVuY3Rpb24gZHJhd1BhcnQocCl7CiAgICAvLyBkcmF3IGEgc2hvcnQgbGluZSBvcmllbnRlZCBhbG9uZyB2ZWxvY2l0eSBkaXJlY3Rpb24KICAgIGNvbnN0IGEgPSBNYXRoLmF0YW4yKHAudnksIHAudngpOwogICAgY29uc3QgZHggPSBNYXRoLmNvcyhhKSAqIHAubGVuICogMC41OwogICAgY29uc3QgZHkgPSBNYXRoLnNpbihhKSAqIHAubGVuICogMC41OwoKICAgIC8vIG5lb24taXNoIHN0cm9rZSArIHNvZnQgZ2xvdyAod2l0aG91dCBjaGFuZ2luZyBnbG9iYWwgcGFsZXR0ZSkKICAgIGJjdHgubGluZVdpZHRoID0gcC53OwogICAgYmN0eC5nbG9iYWxBbHBoYSA9IHAuYWxwaGE7CgogICAgLy8gbWFpbiBsaW5lCiAgICBiY3R4LnNoYWRvd0JsdXIgPSAxODsKICAgIGJjdHguc2hhZG93Q29sb3IgPSBwLmh1ZU1peCA9PT0gJ3BpbmsnID8gJ3JnYmEoMjU1LDQzLDIxNCwuODUpJyA6ICdyZ2JhKDQzLDIxNywyNTUsLjg1KSc7CiAgICBiY3R4LnN0cm9rZVN0eWxlID0gcC5odWVNaXggPT09ICdwaW5rJyA/ICdyZ2JhKDI1NSw0MywyMTQsLjg1KScgOiAncmdiYSg0MywyMTcsMjU1LC44NSknOwogICAgYmN0eC5iZWdpblBhdGgoKTsKICAgIGJjdHgubW92ZVRvKHAueCAtIGR4LCBwLnkgLSBkeSk7CiAgICBiY3R4LmxpbmVUbyhwLnggKyBkeCwgcC55ICsgZHkpOwogICAgYmN0eC5zdHJva2UoKTsKCiAgICAvLyB3aGl0ZSBob3QgY29yZQogICAgYmN0eC5zaGFkb3dCbHVyID0gMTA7CiAgICBiY3R4LnNoYWRvd0NvbG9yID0gJ3JnYmEoMjU1LDI1NSwyNTUsLjc1KSc7CiAgICBiY3R4LnN0cm9rZVN0eWxlID0gJ3JnYmEoMjU1LDI1NSwyNTUsLjc1KSc7CiAgICBiY3R4LmxpbmVXaWR0aCA9IE1hdGgubWF4KDAuOCwgcC53ICogMC41NSk7CiAgICBiY3R4LmJlZ2luUGF0aCgpOwogICAgYmN0eC5tb3ZlVG8ocC54IC0gZHggKiAwLjksIHAueSAtIGR5ICogMC45KTsKICAgIGJjdHgubGluZVRvKHAueCArIGR4ICogMC45LCBwLnkgKyBkeSAqIDAuOSk7CiAgICBiY3R4LnN0cm9rZSgpOwogIH0KCiAgZnVuY3Rpb24gc3RlcEJ1cnN0KHQpewogICAgaWYoIWJ1cnN0UnVubmluZykgcmV0dXJuOwoKICAgIGNvbnN0IG5vdyA9IHQgfHwgcGVyZm9ybWFuY2Uubm93KCk7CiAgICBjb25zdCBkdCA9IE1hdGgubWluKDAuMDIyLCAobm93IC0gKHN0ZXBCdXJzdC5fbHQgfHwgbm93KSkgLyAxMDAwKTsKICAgIHN0ZXBCdXJzdC5fbHQgPSBub3c7CgogICAgLy8gZmFkZSB0cmFpbAogICAgYmN0eC5nbG9iYWxDb21wb3NpdGVPcGVyYXRpb24gPSAnc291cmNlLW92ZXInOwogICAgYmN0eC5nbG9iYWxBbHBoYSA9IDE7CiAgICBiY3R4LmNsZWFyUmVjdCgwLCAwLCB3aW5kb3cuaW5uZXJXaWR0aCwgd2luZG93LmlubmVySGVpZ2h0KTsKCiAgICBjb25zdCBXID0gd2luZG93LmlubmVyV2lkdGgsIEggPSB3aW5kb3cuaW5uZXJIZWlnaHQ7CgogICAgZm9yKGNvbnN0IHAgb2YgYnVyc3RQYXJ0cyl7CiAgICAgIHAueCArPSBwLnZ4ICogZHQ7CiAgICAgIHAueSArPSBwLnZ5ICogZHQ7CgogICAgICAvLyBib3VuY2UvcmVmbGVjdCBvbiBlZGdlcwogICAgICBjb25zdCBwYWQgPSAyOwogICAgICBpZihwLnggPD0gcGFkKXsgcC54ID0gcGFkOyBwLnZ4ICo9IC0xOyB9CiAgICAgIGlmKHAueCA+PSBXIC0gcGFkKXsgcC54ID0gVyAtIHBhZDsgcC52eCAqPSAtMTsgfQogICAgICBpZihwLnkgPD0gcGFkKXsgcC55ID0gcGFkOyBwLnZ5ICo9IC0xOyB9CiAgICAgIGlmKHAueSA+PSBIIC0gcGFkKXsgcC55ID0gSCAtIHBhZDsgcC52eSAqPSAtMTsgfQoKICAgICAgLy8gc3VidGxlIGVuZXJneSBsb3NzCiAgICAgIHAudnggKj0gMC45OTg7CiAgICAgIHAudnkgKj0gMC45OTg7CgogICAgICBkcmF3UGFydChwKTsKICAgIH0KICAgIGJ1cnN0UkFGID0gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKHN0ZXBCdXJzdCk7CiAgfQoKICBmdW5jdGlvbiBzdGFydEJ1cnN0KCl7CiAgICAvLyByZXNwZWN0IHJlZHVjZWQgbW90aW9uCiAgICBpZiAod2luZG93Lm1hdGNoTWVkaWEgJiYgd2luZG93Lm1hdGNoTWVkaWEoJyhwcmVmZXJzLXJlZHVjZWQtbW90aW9uOiByZWR1Y2UpJykubWF0Y2hlcykgcmV0dXJuOwoKICAgIHJlc2l6ZUJ1cnN0KCk7CiAgICBidXJzdFBhcnRzID0gW107CiAgICBmb3IobGV0IGk9MDsgaTwxMDA7IGkrKykgYnVyc3RQYXJ0cy5wdXNoKG1ha2VQYXJ0KCkpOwoKICAgIGJ1cnN0UnVubmluZyA9IHRydWU7CiAgICBidXJzdFN0YXJ0VCA9IHBlcmZvcm1hbmNlLm5vdygpOwogICAgc3RlcEJ1cnN0Ll9sdCA9IGJ1cnN0U3RhcnRUOwoKICAgIC8vIGNsZWFyCiAgICBiY3R4LmNsZWFyUmVjdCgwLDAsd2luZG93LmlubmVyV2lkdGgsIHdpbmRvdy5pbm5lckhlaWdodCk7CiAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5hZGQoJ2J1cnN0LW9uJyk7CiAgICBidXJzdFJBRiA9IHJlcXVlc3RBbmltYXRpb25GcmFtZShzdGVwQnVyc3QpOwogIH0KCiAgZnVuY3Rpb24gc3RvcEJ1cnN0KCl7CiAgICBidXJzdFJ1bm5pbmcgPSBmYWxzZTsKICAgIGNhbmNlbEFuaW1hdGlvbkZyYW1lKGJ1cnN0UkFGKTsKICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LnJlbW92ZSgnYnVyc3Qtb24nKTsKCiAgICAvLyBmYWRlIG91dCBxdWlja2x5IHRoZW4gY2xlYXIKICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICBiY3R4LmNsZWFyUmVjdCgwLDAsd2luZG93LmlubmVyV2lkdGgsIHdpbmRvdy5pbm5lckhlaWdodCk7CiAgICB9LCAyMjApOwogIH0KCgogIGZ1bmN0aW9uIHN0YXJ0TG9nbygpewogICAgY29uc3QgdGV4dCA9IHRpdGxlLnRleHRDb250ZW50LnRyaW0oKTsKICAgIHRpdGxlLnRleHRDb250ZW50ID0gJyc7CgogICAgY29uc3QgZnJhZyA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTsKICAgIGZvciAobGV0IGk9MDsgaTx0ZXh0Lmxlbmd0aDsgaSsrKXsKICAgICAgY29uc3Qgc3BhbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTsKICAgICAgc3Bhbi5jbGFzc05hbWUgPSAnbGV0dGVyJzsKICAgICAgc3Bhbi50ZXh0Q29udGVudCA9IHRleHRbaV07CiAgICAgIGZyYWcuYXBwZW5kQ2hpbGQoc3Bhbik7CiAgICB9CiAgICB0aXRsZS5hcHBlbmRDaGlsZChmcmFnKTsKCiAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4gewogICAgICB0aXRsZS5jbGFzc0xpc3QuYWRkKCdyZWFkeScpOwoKICAgICAgLy8gU1RBUlQgYmFja2dyb3VuZCBwdWxzZSBzeW5jZWQgd2l0aCBsb2dvCiAgICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LmFkZCgnbG9nby1vbicpOwogICAgfSk7CgogICAgY29uc3QgbGV0dGVycyA9IEFycmF5LmZyb20odGl0bGUucXVlcnlTZWxlY3RvckFsbCgnLmxldHRlcicpKTsKICAgIGNvbnN0IEJBU0VfREVMQVkgPSA0MiwgUkFORE9NX0pJVFRFUiA9IDkwLCBPVkVSTEFQX09GRlNFVCA9IDE4MDsKCiAgICBsZXR0ZXJzLmZvckVhY2goKGVsLCBpZHgpID0+IHsKICAgICAgY29uc3QgZGVsYXkgPSBpZHggKiBCQVNFX0RFTEFZICsgTWF0aC5yYW5kb20oKSAqIFJBTkRPTV9KSVRURVIgLSBPVkVSTEFQX09GRlNFVDsKICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgZWwuY2xhc3NMaXN0LmFkZCgnc2hvdycpOwogICAgICAgIHNldFRpbWVvdXQoKCkgPT4gZWwuY2xhc3NMaXN0LmFkZCgnZmxvdycpLCAxODApOwogICAgICB9LCBNYXRoLm1heCgwLCBkZWxheSkpOwogICAgfSk7CgogICAgc2V0VGltZW91dCgoKSA9PiBzdWJ0aXRsZS5jbGFzc0xpc3QuYWRkKCdzaG93JyksCiAgICAgIE1hdGgubWF4KDkwMCwgbGV0dGVycy5sZW5ndGggKiBCQVNFX0RFTEFZICogMC43MikKICAgICk7CiAgfQoKICAKICAKICAvLyA9PT09PSBLRVlCT0FSRCBDT05UUk9MUyAoRU5URVIgPSBJTlNFUlQsIEVTQyA9IEZVTExTQ1JFRU4gVE9HR0xFKSA9PT09PQogIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCAoZSkgPT4gewoKICAgIC8vIEVOVEVSID0gSU5TRVJUCiAgICBpZiAoZS5rZXkgPT09ICdFbnRlcicpIHsKICAgICAgY29uc3QgYnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2dvQnRuJyk7CiAgICAgIGlmIChidG4gJiYgIWJ0bi5kaXNhYmxlZCkgewogICAgICAgIGJ0bi5jbGljaygpOwogICAgICB9CiAgICB9CgogICAgLy8gRVNDID0gRlVMTFNDUkVFTiBUT0dHTEUKICAgIGlmIChlLmtleSA9PT0gJ0VzY2FwZScpIHsKICAgICAgLy8gTm90ZTogc29tZSBicm93c2VycyBtYXkgc3RpbGwgdXNlIEVTQyB0byBleGl0IGZ1bGxzY3JlZW4sIGJ1dCB0aGlzIHdvcmtzIHJlbGlhYmx5IHRvIEVOVEVSIGZ1bGxzY3JlZW4gd2hlbiBub3QgZnVsbHNjcmVlbi4KICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICBjb25zdCBlbCA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudDsKCiAgICAgIGlmICghZG9jdW1lbnQuZnVsbHNjcmVlbkVsZW1lbnQpIHsKICAgICAgICBpZiAoZWwucmVxdWVzdEZ1bGxzY3JlZW4pIGVsLnJlcXVlc3RGdWxsc2NyZWVuKCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaWYgKGRvY3VtZW50LmV4aXRGdWxsc2NyZWVuKSBkb2N1bWVudC5leGl0RnVsbHNjcmVlbigpOwogICAgICB9CiAgICB9CgogIH0pOwpmdW5jdGlvbiB0b2dnbGVGdWxsc2NyZWVuKCl7CiAgICBjb25zdCBkb2MgPSBkb2N1bWVudDsKICAgIGNvbnN0IGVsID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50OwogICAgaWYgKCFkb2MuZnVsbHNjcmVlbkVsZW1lbnQgJiYKICAgICAgICAhZG9jLndlYmtpdEZ1bGxzY3JlZW5FbGVtZW50ICYmCiAgICAgICAgIWRvYy5tb3pGdWxsU2NyZWVuRWxlbWVudCAmJgogICAgICAgICFkb2MubXNGdWxsc2NyZWVuRWxlbWVudCkgewoKICAgICAgaWYgKGVsLnJlcXVlc3RGdWxsc2NyZWVuKSBlbC5yZXF1ZXN0RnVsbHNjcmVlbigpOwogICAgICBlbHNlIGlmIChlbC53ZWJraXRSZXF1ZXN0RnVsbHNjcmVlbikgZWwud2Via2l0UmVxdWVzdEZ1bGxzY3JlZW4oKTsKICAgICAgZWxzZSBpZiAoZWwubW96UmVxdWVzdEZ1bGxTY3JlZW4pIGVsLm1velJlcXVlc3RGdWxsU2NyZWVuKCk7CiAgICAgIGVsc2UgaWYgKGVsLm1zUmVxdWVzdEZ1bGxzY3JlZW4pIGVsLm1zUmVxdWVzdEZ1bGxzY3JlZW4oKTsKCiAgICB9IGVsc2UgewogICAgICBpZiAoZG9jLmV4aXRGdWxsc2NyZWVuKSBkb2MuZXhpdEZ1bGxzY3JlZW4oKTsKICAgICAgZWxzZSBpZiAoZG9jLndlYmtpdEV4aXRGdWxsc2NyZWVuKSBkb2Mud2Via2l0RXhpdEZ1bGxzY3JlZW4oKTsKICAgICAgZWxzZSBpZiAoZG9jLm1vekNhbmNlbEZ1bGxTY3JlZW4pIGRvYy5tb3pDYW5jZWxGdWxsU2NyZWVuKCk7CiAgICAgIGVsc2UgaWYgKGRvYy5tc0V4aXRGdWxsc2NyZWVuKSBkb2MubXNFeGl0RnVsbHNjcmVlbigpOwogICAgfQogIH0KCn0pKCk7Cjwvc2NyaXB0Pgo8L2JvZHk+CjwvaHRtbD4K";
    const MAIN_B64  = "PCFkb2N0eXBlIGh0bWw+CjxodG1sIGxhbmc9ImVsIj4KPGhlYWQ+CiAgPG1ldGEgY2hhcnNldD0idXRmLTgiIC8+CiAgPG1ldGEgbmFtZT0idmlld3BvcnQiIGNvbnRlbnQ9IndpZHRoPWRldmljZS13aWR0aCwgaW5pdGlhbC1zY2FsZT0xIiAvPgogIDx0aXRsZT5OZW9uIEF3YXJkcyBGb3JtPC90aXRsZT4KICAKICA8c3R5bGU+CiAgICA6cm9vdHsKICAgICAgLS1iZzojMDcwODE3OwogICAgICAtLWJnMjojMDUwNjEyOwogICAgICAtLWNhcmQ6IHJnYmEoMjU1LDI1NSwyNTUsLjA2KTsKICAgICAgLS1jYXJkMjogcmdiYSgyNTUsMjU1LDI1NSwuMDQpOwogICAgICAtLWJvcmRlcjogcmdiYSgyNTUsMjU1LDI1NSwuMTApOwogICAgICAtLXRleHQ6I2ZmZmZmZjsKICAgICAgLS1tdXRlZDogcmdiYSgyNTUsMjU1LDI1NSwuNzApOwogICAgICAtLW11dGVkMjogcmdiYSgyNTUsMjU1LDI1NSwuNTApOwoKICAgICAgLS1waW5rOiNmZjJlYTY7CiAgICAgIC0tYmx1ZTojMDBkMWZmOwoKICAgICAgLS1yaW5nOiAwIDAgMCAycHggcmdiYSgwLDIwOSwyNTUsLjMwKSwgMCAwIDI0cHggcmdiYSgyNTUsNDYsMTY2LC4xOCk7CiAgICAgIC0tc2hhZG93OiAwIDE0cHggNDBweCByZ2JhKDAsMCwwLC40NSk7CiAgICAgIC0tZ2xvdzogMCAwIDIwcHggcmdiYSgwLDIwOSwyNTUsLjIyKSwgMCAwIDI2cHggcmdiYSgyNTUsNDYsMTY2LC4xOCk7CiAgICAgIC0tcmFkaXVzOiAxOHB4OwogICAgfQoKICAgICp7IGJveC1zaXppbmc6Ym9yZGVyLWJveDsgfQogICAgaHRtbCxib2R5eyBoZWlnaHQ6MTAwJTsgfQogICAgYm9keXsKICAgICAgbWFyZ2luOjA7CiAgICAgIGNvbG9yOnZhcigtLXRleHQpOwogICAgICBmb250LWZhbWlseTogdWktc2Fucy1zZXJpZiwgc3lzdGVtLXVpLCAtYXBwbGUtc3lzdGVtLCBTZWdvZSBVSSwgUm9ib3RvLCAiSGVsdmV0aWNhIE5ldWUiLCBBcmlhbCwgIk5vdG8gU2FucyIsICJBcHBsZSBDb2xvciBFbW9qaSIsICJTZWdvZSBVSSBFbW9qaSI7CiAgICAgIGJhY2tncm91bmQ6CiAgICAgICAgcmFkaWFsLWdyYWRpZW50KDkwMHB4IDQyMHB4IGF0IDE1JSAxNSUsIHJnYmEoMjU1LDQ2LDE2NiwuMTgpLCB0cmFuc3BhcmVudCA2MCUpLAogICAgICAgIHJhZGlhbC1ncmFkaWVudCg5MDBweCA0MjBweCBhdCA4NSUgMjAlLCByZ2JhKDAsMjA5LDI1NSwuMTYpLCB0cmFuc3BhcmVudCA2MCUpLAogICAgICAgIGxpbmVhci1ncmFkaWVudCgxODBkZWcsIHZhcigtLWJnKSAwJSwgdmFyKC0tYmcyKSAxMDAlKTsKICAgICAgb3ZlcmZsb3cteDpoaWRkZW47CiAgICB9CgogICAgLyogY2xlYW4gbmVvbiBzY3JvbGxiYXIgKi8KICAgIDo6LXdlYmtpdC1zY3JvbGxiYXJ7IHdpZHRoOjEwcHg7IGhlaWdodDoxMHB4OyB9CiAgICA6Oi13ZWJraXQtc2Nyb2xsYmFyLXRodW1iewogICAgICBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoMTgwZGVnLCByZ2JhKDI1NSw0NiwxNjYsLjc1KSwgcmdiYSgwLDIwOSwyNTUsLjc1KSk7CiAgICAgIGJvcmRlci1yYWRpdXM6OTk5cHg7CiAgICB9CiAgICA6Oi13ZWJraXQtc2Nyb2xsYmFyLXRyYWNreyBiYWNrZ3JvdW5kOiByZ2JhKDI1NSwyNTUsMjU1LC4wNik7IH0KCiAgICBheyBjb2xvcjppbmhlcml0OyB9CiAgICBidXR0b24sIGlucHV0eyBmb250OmluaGVyaXQ7IGNvbG9yOmluaGVyaXQ7IH0KCiAgICAud3JhcHsKICAgICAgbWF4LXdpZHRoOiA5ODBweDsKICAgICAgbWFyZ2luOiAwIGF1dG87CiAgICAgIHBhZGRpbmc6IDI2cHggMTZweCA2NHB4OwogICAgfQoKICAgIC8qID09PT09IEhlYWRlciA9PT09PSAqLwogICAgLmhlYWRlcnsKICAgICAgZGlzcGxheTpmbGV4OwogICAgICBnYXA6MTRweDsKICAgICAgYWxpZ24taXRlbXM6Y2VudGVyOwogICAgICBtYXJnaW4tYm90dG9tOiAxNHB4OwogICAgfQogICAgLmxvZ297CiAgICAgIHdpZHRoOjQwcHg7CiAgICAgIGhlaWdodDo0MHB4OwogICAgICBib3JkZXItcmFkaXVzOiAxNHB4OwogICAgICBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCByZ2JhKDI1NSw0NiwxNjYsLjk1KSwgcmdiYSgwLDIwOSwyNTUsLjk1KSk7CiAgICAgIGJveC1zaGFkb3c6IHZhcigtLWdsb3cpOwogICAgfQogICAgaDF7CiAgICAgIG1hcmdpbjowOwogICAgICBmb250LXNpemU6IGNsYW1wKDIycHgsIDN2dywgMzRweCk7CiAgICAgIGxldHRlci1zcGFjaW5nOi0wLjAyZW07CiAgICB9CiAgICAuc3VidGl0bGV7CiAgICAgIG1hcmdpbjo4cHggMCAwOwogICAgICBjb2xvcjogdmFyKC0tbXV0ZWQpOwogICAgICBtYXgtd2lkdGg6IDc1Y2g7CiAgICAgIGxpbmUtaGVpZ2h0OiAxLjQ1OwogICAgICBmb250LXNpemU6IDE0cHg7CiAgICB9CgogICAgLyogPT09PT0gU2ltcGxlIHNoZWxsL2NhcmQgPT09PT0gKi8KICAgIC5jYXJkewogICAgICBib3JkZXItcmFkaXVzOiAyMnB4OwogICAgICBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoMTgwZGVnLCB2YXIoLS1jYXJkKSAwJSwgdmFyKC0tY2FyZDIpIDEwMCUpOwogICAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXIpOwogICAgICBib3gtc2hhZG93OiB2YXIoLS1zaGFkb3cpOwogICAgICBiYWNrZHJvcC1maWx0ZXI6IGJsdXIoMTJweCk7CiAgICB9CgogICAgLyogPT09PT0gSG9tZSBncmlkID09PT09ICovCiAgICAuZ3JpZDR7CiAgICAgIGRpc3BsYXk6Z3JpZDsKICAgICAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnI7CiAgICAgIGdhcDogMTJweDsKICAgICAgcGFkZGluZzogMTZweDsKICAgIH0KICAgIEBtZWRpYSAobWluLXdpZHRoOiA2NDBweCl7IC5ncmlkNHsgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiByZXBlYXQoMiwgbWlubWF4KDAsMWZyKSk7IH0gfQogICAgQG1lZGlhIChtaW4td2lkdGg6IDk4MHB4KXsgLmdyaWQ0eyBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IHJlcGVhdCgzLCBtaW5tYXgoMCwxZnIpKTsgfSB9CgogICAgLnBlcnNvbi10aWxleyBwb3NpdGlvbjpyZWxhdGl2ZTsgfQogICAgLnBlcnNvbi1idG57CiAgICAgIHdpZHRoOjEwMCU7CiAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJvcmRlcik7CiAgICAgIGJhY2tncm91bmQ6IHJnYmEoMjU1LDI1NSwyNTUsLjA0KTsKICAgICAgYm9yZGVyLXJhZGl1czogdmFyKC0tcmFkaXVzKTsKICAgICAgcGFkZGluZzogMTZweCAxNHB4OwogICAgICBjdXJzb3I6cG9pbnRlcjsKICAgICAgdGV4dC1hbGlnbjpsZWZ0OwogICAgICB0cmFuc2l0aW9uOiB0cmFuc2Zvcm0gLjE0cyBlYXNlLCBib3JkZXItY29sb3IgLjE0cyBlYXNlLCBiYWNrZ3JvdW5kIC4xNHMgZWFzZSwgYm94LXNoYWRvdyAuMTRzIGVhc2U7CiAgICB9CiAgICAucGVyc29uLWJ0bjpob3ZlcnsKICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC0xcHgpOwogICAgICBiYWNrZ3JvdW5kOiByZ2JhKDI1NSwyNTUsMjU1LC4wNik7CiAgICAgIGJvcmRlci1jb2xvcjogcmdiYSgyNTUsMjU1LDI1NSwuMTYpOwogICAgICBib3gtc2hhZG93OiB2YXIoLS1nbG93KTsKICAgIH0KICAgIC5wZXJzb24tdGl0bGV7IGZvbnQtd2VpZ2h0OjgwMDsgZm9udC1zaXplOjE2cHg7IH0KICAgIC5wZXJzb24tc3VieyBtYXJnaW4tdG9wOjZweDsgZm9udC1zaXplOjEycHg7IGNvbG9yOiB2YXIoLS1tdXRlZDIpOyB9CgogICAgLnN5bmMtbWluaXsKICAgICAgcG9zaXRpb246YWJzb2x1dGU7CiAgICAgIHRvcDoxMHB4OyByaWdodDoxMHB4OwogICAgICBwYWRkaW5nOiA4cHggMTBweDsKICAgICAgYm9yZGVyLXJhZGl1czogMTRweDsKICAgICAgYm9yZGVyOiAxcHggc29saWQgcmdiYSgyNTUsMjU1LDI1NSwuMTQpOwogICAgICBiYWNrZ3JvdW5kOiByZ2JhKDAsMCwwLC4yNSk7CiAgICAgIGN1cnNvcjpwb2ludGVyOwogICAgICBmb250LXNpemU6MTJweDsKICAgICAgYmFja2Ryb3AtZmlsdGVyOiBibHVyKDEwcHgpOwogICAgICB0cmFuc2l0aW9uOiB0cmFuc2Zvcm0gLjE0cyBlYXNlLCBib3JkZXItY29sb3IgLjE0cyBlYXNlLCBiYWNrZ3JvdW5kIC4xNHMgZWFzZSwgYm94LXNoYWRvdyAuMTRzIGVhc2U7CiAgICB9CiAgICAuc3luYy1taW5pOmhvdmVyewogICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTFweCk7CiAgICAgIGJvcmRlci1jb2xvcjogcmdiYSgyNTUsMjU1LDI1NSwuMjIpOwogICAgICBiYWNrZ3JvdW5kOiByZ2JhKDAsMCwwLC4zNSk7CiAgICAgIGJveC1zaGFkb3c6IHZhcigtLWdsb3cpOwogICAgfQogICAgLnN5bmMtbWluaTpmb2N1c3sgb3V0bGluZTogbm9uZTsgYm94LXNoYWRvdzogdmFyKC0tcmluZyk7IH0KCiAgICAvKiA9PT09PSBQZXJzb24gdmlldyB0b3BiYXIgPT09PT0gKi8KICAgIC50b3BiYXJ7CiAgICAgIGRpc3BsYXk6ZmxleDsKICAgICAgZmxleC13cmFwOndyYXA7CiAgICAgIGdhcDogMTJweDsKICAgICAgYWxpZ24taXRlbXM6ZmxleC1zdGFydDsKICAgICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOwogICAgICBtYXJnaW46IDhweCAwIDE0cHg7CiAgICB9CgogICAgLmJhY2t7CiAgICAgIGJvcmRlcjpub25lOwogICAgICBiYWNrZ3JvdW5kOiB0cmFuc3BhcmVudDsKICAgICAgcGFkZGluZzogNnB4IDA7CiAgICAgIGNvbG9yOiB2YXIoLS1tdXRlZCk7CiAgICAgIGN1cnNvcjpwb2ludGVyOwogICAgfQogICAgLmJhY2s6aG92ZXJ7IGNvbG9yOiAjZmZmOyB9CgogICAgLmFjdGlvbnN7CiAgICAgIGRpc3BsYXk6ZmxleDsKICAgICAgYWxpZ24taXRlbXM6Y2VudGVyOwogICAgICBnYXA6IDEwcHg7CiAgICAgIGZsZXgtd3JhcDp3cmFwOwogICAgfQoKICAgIC5waWxsewogICAgICBkaXNwbGF5OmlubGluZS1mbGV4OwogICAgICBhbGlnbi1pdGVtczpjZW50ZXI7CiAgICAgIGdhcDogOHB4OwogICAgICBwYWRkaW5nOiAxMHB4IDEycHg7CiAgICAgIGJvcmRlci1yYWRpdXM6IDk5OXB4OwogICAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXIpOwogICAgICBiYWNrZ3JvdW5kOiByZ2JhKDAsMCwwLC4xOCk7CiAgICAgIGNvbG9yOiB2YXIoLS1tdXRlZCk7CiAgICAgIGZvbnQtc2l6ZTogMTJweDsKICAgIH0KICAgIC5waWxsIHN0cm9uZ3sgY29sb3I6I2ZmZjsgZm9udC13ZWlnaHQ6ODAwOyB9CgogICAgLmFjdGlvbnsKICAgICAgcGFkZGluZzogMTBweCAxMnB4OwogICAgICBib3JkZXItcmFkaXVzOiA5OTlweDsKICAgICAgYm9yZGVyOiAxcHggc29saWQgcmdiYSgyNTUsMjU1LDI1NSwuMTQpOwogICAgICBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCByZ2JhKDI1NSw0NiwxNjYsLjE2KSwgcmdiYSgwLDIwOSwyNTUsLjE0KSk7CiAgICAgIGN1cnNvcjpwb2ludGVyOwogICAgICB0cmFuc2l0aW9uOiB0cmFuc2Zvcm0gLjE0cyBlYXNlLCBib3gtc2hhZG93IC4xNHMgZWFzZSwgYm9yZGVyLWNvbG9yIC4xNHMgZWFzZTsKICAgIH0KICAgIC5hY3Rpb246aG92ZXJ7IHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtMXB4KTsgYm94LXNoYWRvdzogdmFyKC0tZ2xvdyk7IGJvcmRlci1jb2xvcjogcmdiYSgyNTUsMjU1LDI1NSwuMjIpOyB9CiAgICAuYWN0aW9uOmZvY3VzeyBvdXRsaW5lOm5vbmU7IGJveC1zaGFkb3c6IHZhcigtLXJpbmcpOyB9CgogICAgLyogPT09PT0gQ2F0ZWdvcmllcyA9PT09PSAqLwogICAgLmNhdHN7CiAgICAgIGRpc3BsYXk6Z3JpZDsKICAgICAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnI7CiAgICAgIGdhcDogMTRweDsKICAgICAgcGFkZGluZzogMTZweDsKICAgIH0KICAgIEBtZWRpYSAobWluLXdpZHRoOiA5ODBweCl7IC5jYXRzeyBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciAxZnI7IH0gfQoKICAgIC5jYXR7CiAgICAgIGJvcmRlci1yYWRpdXM6IDIwcHg7CiAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJvcmRlcik7CiAgICAgIGJhY2tncm91bmQ6IHJnYmEoMjU1LDI1NSwyNTUsLjA0KTsKICAgICAgcGFkZGluZzogMTRweDsKICAgIH0KICAgIC5jYXQgaDJ7IG1hcmdpbjowOyBmb250LXNpemU6IDE0cHg7IGZvbnQtd2VpZ2h0OiA4MDA7IGxldHRlci1zcGFjaW5nOiAuMDFlbTsgfQogICAgLnN0YXR1c3sKICAgICAgbWFyZ2luLXRvcDogNnB4OwogICAgICBmb250LXNpemU6IDEycHg7CiAgICAgIGNvbG9yOiB2YXIoLS1tdXRlZDIpOwogICAgfQogICAgLnN0YXR1cy5vbnsgY29sb3I6IHJnYmEoMCwyMDksMjU1LC45MCk7IH0KCiAgICAuY2F0LWhlYWR7CiAgICAgIGRpc3BsYXk6ZmxleDsKICAgICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOwogICAgICBnYXA6IDEwcHg7CiAgICAgIGFsaWduLWl0ZW1zOmZsZXgtc3RhcnQ7CiAgICAgIG1hcmdpbi1ib3R0b206IDEwcHg7CiAgICB9CgogICAgLm1pbml7CiAgICAgIGJvcmRlci1yYWRpdXM6IDk5OXB4OwogICAgICBib3JkZXI6IDFweCBzb2xpZCByZ2JhKDI1NSwyNTUsMjU1LC4xNCk7CiAgICAgIGJhY2tncm91bmQ6IHJnYmEoMCwwLDAsLjE4KTsKICAgICAgcGFkZGluZzogOHB4IDEwcHg7CiAgICAgIGZvbnQtc2l6ZTogMTJweDsKICAgICAgY3Vyc29yOnBvaW50ZXI7CiAgICAgIHRyYW5zaXRpb246IHRyYW5zZm9ybSAuMTRzIGVhc2UsIGJveC1zaGFkb3cgLjE0cyBlYXNlLCBiYWNrZ3JvdW5kIC4xNHMgZWFzZSwgYm9yZGVyLWNvbG9yIC4xNHMgZWFzZTsKICAgIH0KICAgIC5taW5pOmhvdmVyewogICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTFweCk7CiAgICAgIGJhY2tncm91bmQ6IHJnYmEoMCwwLDAsLjI4KTsKICAgICAgYm9yZGVyLWNvbG9yOiByZ2JhKDI1NSwyNTUsMjU1LC4yMik7CiAgICAgIGJveC1zaGFkb3c6IHZhcigtLWdsb3cpOwogICAgfQogICAgLm1pbmk6Zm9jdXN7IG91dGxpbmU6bm9uZTsgYm94LXNoYWRvdzogdmFyKC0tcmluZyk7IH0KCiAgICAubGlzdHsgZGlzcGxheTpmbGV4OyBmbGV4LWRpcmVjdGlvbjogY29sdW1uOyBnYXA6IDhweDsgfQoKICAgIC5yb3d7CiAgICAgIGRpc3BsYXk6ZmxleDsKICAgICAgYWxpZ24taXRlbXM6Y2VudGVyOwogICAgICBnYXA6IDEwcHg7CiAgICAgIHBhZGRpbmc6IDEwcHggMTJweDsKICAgICAgYm9yZGVyLXJhZGl1czogMTZweDsKICAgICAgYm9yZGVyOiAxcHggc29saWQgcmdiYSgyNTUsMjU1LDI1NSwuMTApOwogICAgICBiYWNrZ3JvdW5kOiByZ2JhKDAsMCwwLC4xNik7CiAgICAgIHRyYW5zaXRpb246IHRyYW5zZm9ybSAuMTJzIGVhc2UsIGJvcmRlci1jb2xvciAuMTJzIGVhc2UsIGJveC1zaGFkb3cgLjEycyBlYXNlLCBiYWNrZ3JvdW5kIC4xMnMgZWFzZTsKICAgICAgcG9zaXRpb246cmVsYXRpdmU7CiAgICB9CiAgICAucm93LmRyYWctZW5hYmxlZDpob3ZlcnsKICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC0xcHgpOwogICAgICBib3JkZXItY29sb3I6IHJnYmEoMjU1LDI1NSwyNTUsLjE4KTsKICAgICAgYm94LXNoYWRvdzogMCAwIDAgMXB4IHJnYmEoMCwyMDksMjU1LC4xNSksIDAgMCAxOHB4IHJnYmEoMjU1LDQ2LDE2NiwuMTIpOwogICAgICBiYWNrZ3JvdW5kOiByZ2JhKDAsMCwwLC4yMCk7CiAgICB9CiAgICAucm93LmRyYWdnaW5newogICAgICBvdXRsaW5lOiBub25lOwogICAgICBib3gtc2hhZG93OiB2YXIoLS1yaW5nKTsKICAgICAgdHJhbnNmb3JtOiBzY2FsZSgxLjAxKTsKICAgIH0KCiAgICAuaGFuZGxlewogICAgICB3aWR0aDogMzRweDsKICAgICAgaGVpZ2h0OiAzNHB4OwogICAgICBkaXNwbGF5OmZsZXg7CiAgICAgIGFsaWduLWl0ZW1zOmNlbnRlcjsKICAgICAganVzdGlmeS1jb250ZW50OmNlbnRlcjsKICAgICAgYm9yZGVyLXJhZGl1czogMTJweDsKICAgICAgYm9yZGVyOiAxcHggc29saWQgcmdiYSgyNTUsMjU1LDI1NSwuMTIpOwogICAgICBiYWNrZ3JvdW5kOiByZ2JhKDI1NSwyNTUsMjU1LC4wNCk7CiAgICAgIGNvbG9yOiByZ2JhKDI1NSwyNTUsMjU1LC43NSk7CiAgICAgIHVzZXItc2VsZWN0Om5vbmU7CiAgICB9CiAgICAucm93LmRyYWctZW5hYmxlZCAuaGFuZGxleyBjdXJzb3I6IGdyYWI7IH0KICAgIC5yb3cuZHJhZy1lbmFibGVkIC5oYW5kbGU6YWN0aXZleyBjdXJzb3I6IGdyYWJiaW5nOyB9CiAgICAuaGFuZGxlLm9mZnsgb3BhY2l0eTogLjQ1OyB9CgogICAgLm51bXsKICAgICAgd2lkdGg6IDI2cHg7CiAgICAgIHRleHQtYWxpZ246Y2VudGVyOwogICAgICBmb250LXNpemU6IDEycHg7CiAgICAgIGNvbG9yOiByZ2JhKDI1NSwyNTUsMjU1LC41NSk7CiAgICAgIGZvbnQtdmFyaWFudC1udW1lcmljOiB0YWJ1bGFyLW51bXM7CiAgICB9CgogICAgaW5wdXQudGV4dHsKICAgICAgZmxleDogMTsKICAgICAgd2lkdGg6MTAwJTsKICAgICAgYm9yZGVyLXJhZGl1czogMTRweDsKICAgICAgYm9yZGVyOiAxcHggc29saWQgcmdiYSgyNTUsMjU1LDI1NSwuMTIpOwogICAgICBiYWNrZ3JvdW5kOiByZ2JhKDI1NSwyNTUsMjU1LC4wNCk7CiAgICAgIHBhZGRpbmc6IDEwcHggMTJweDsKICAgICAgb3V0bGluZTpub25lOwogICAgfQogICAgaW5wdXQudGV4dDo6cGxhY2Vob2xkZXJ7IGNvbG9yOiByZ2JhKDI1NSwyNTUsMjU1LC4zNSk7IH0KICAgIGlucHV0LnRleHQ6Zm9jdXN7IGJveC1zaGFkb3c6IHZhcigtLXJpbmcpOyBib3JkZXItY29sb3I6IHRyYW5zcGFyZW50OyB9CgogICAgLnNjb3JlewogICAgICB3aWR0aDogNjRweDsKICAgICAgZGlzcGxheTpmbGV4OwogICAgICBqdXN0aWZ5LWNvbnRlbnQ6ZmxleC1lbmQ7CiAgICB9CiAgICAuYmFkZ2V7CiAgICAgIG1pbi13aWR0aDogNDZweDsKICAgICAgdGV4dC1hbGlnbjpjZW50ZXI7CiAgICAgIHBhZGRpbmc6IDhweCAxMHB4OwogICAgICBib3JkZXItcmFkaXVzOiA5OTlweDsKICAgICAgYm9yZGVyOiAxcHggc29saWQgcmdiYSgyNTUsMjU1LDI1NSwuMTIpOwogICAgICBiYWNrZ3JvdW5kOiByZ2JhKDI1NSwyNTUsMjU1LC4wNCk7CiAgICAgIGNvbG9yOiByZ2JhKDI1NSwyNTUsMjU1LC43MCk7CiAgICAgIGZvbnQtd2VpZ2h0OiA4MDA7CiAgICAgIGZvbnQtc2l6ZTogMTJweDsKICAgICAgZm9udC12YXJpYW50LW51bWVyaWM6IHRhYnVsYXItbnVtczsKICAgIH0KICAgIC5yb3cuZHJhZy1lbmFibGVkIC5iYWRnZXsKICAgICAgY29sb3I6I2ZmZjsKICAgICAgYm9yZGVyLWNvbG9yOiByZ2JhKDI1NSwyNTUsMjU1LC4xOCk7CiAgICAgIGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCgxMzVkZWcsIHJnYmEoMjU1LDQ2LDE2NiwuNzUpLCByZ2JhKDAsMjA5LDI1NSwuNzUpKTsKICAgICAgYm94LXNoYWRvdzogMCAwIDE0cHggcmdiYSgwLDIwOSwyNTUsLjIyKSwgMCAwIDE0cHggcmdiYSgyNTUsNDYsMTY2LC4xOCk7CiAgICB9CgogICAgLmdyaWQtYmd7IGRpc3BsYXk6bm9uZTsgfQoKICAgIC5oaW50ewogICAgICBtYXJnaW4tdG9wOiAxMnB4OwogICAgICBjb2xvcjogdmFyKC0tbXV0ZWQyKTsKICAgICAgZm9udC1zaXplOiAxMnB4OwogICAgICBwYWRkaW5nOiAwIDJweDsKICAgIH0KCiAgICAuaGlkZGVueyBkaXNwbGF5Om5vbmUgIWltcG9ydGFudDsgfQogIDwvc3R5bGU+Cgo8L2hlYWQ+Cgo8Ym9keT4KICA8ZGl2IGNsYXNzPSJ3cmFwIj4KICAgIDxkaXYgaWQ9ImhvbWVWaWV3Ij4KICAgICAgPGRpdiBjbGFzcz0iaGVhZGVyIj4KICAgICAgICA8ZGl2IGNsYXNzPSJsb2dvIj48L2Rpdj4KICAgICAgICA8ZGl2PgogICAgICAgICAgPGgxPk5lb24gQXdhcmRzIEZvcm08L2gxPgogICAgICAgICAgPHAgY2xhc3M9InN1YnRpdGxlIj4KICAgICAgICAgICAgzpTOuc6szrvOtc6+zrUgzqzPhM6/zrzOvy4gzprOrM64zrUgz4POtc67zq/OtM6xIM6tz4fOtc65IDEwIM66zrHPhM63zrPOv8+Bzq/Otc+CIM66zrHOuSDOv865IM6zz4HOsc68zrzOrc+CIM+Az4HOv8+DzrHPgc68z4zOts6/zr3PhM6xzrkgzrHPhc+Ez4zOvM6xz4TOsSAozrHPgM+MIEV4Y2VsIM6uIM+HzrXOuc+Bzr/Ous6vzr3Ot8+EzrEpLgogICAgICAgICAgICDOnM+MzrvOuc+CIM+Fz4DOrM+Bz4fOv8+Fzr0gPHN0cm9uZz7PhM6/z4XOu86sz4fOuc+Dz4TOv869IDI8L3N0cm9uZz4gz4PPhc68z4DOu863z4HPic68zq3Ovc6/zrkgz4TOr8+EzrvOv865IM+DzrUgzrzOuc6xIM66zrHPhM63zrPOv8+Bzq/OsSwgzrXOvc61z4HOs86/z4DOv865zrXOr8+EzrHOuSBkcmFnICYgZHJvcCDOus6xz4TOrM+EzrHOvs63CiAgICAgICAgICAgIM66zrHOuSDOvM+AzrHOr869zrXOuSDOsc+Fz4TPjM68zrHPhM6xIHNjb3JlICgxMuKAkzEpLgogICAgICAgICAgPC9wPgogICAgICAgIDwvZGl2PgogICAgICAgIAo8YnV0dG9uIGNsYXNzPSJhY3Rpb24iIGlkPSJzdGF0c0J0biIgdGl0bGU9Is6jz4XOs866zrXOvc+Ez4HPic+EzrnOus6sIM+Dz4TOsc+EzrnPg8+EzrnOus6sICYgRXhwb3J0IEV4Y2VsIj4KICDwn5OKIEphbWVzIFJpZ2FzCjwvYnV0dG9uPgoKICAgICAgPC9kaXY+CgogICAgICA8ZGl2IGNsYXNzPSIiPgogICAgICAgIDxkaXYgY2xhc3M9ImNhcmQiPgogICAgICAgICAgPGRpdiBjbGFzcz0iZ3JpZDQiIGlkPSJwZW9wbGVHcmlkIj48L2Rpdj4KICAgICAgICA8L2Rpdj4KICAgICAgPC9kaXY+CgogICAgICA8ZGl2IGNsYXNzPSJncmlkLWJnIj48L2Rpdj4KICAgIDwvZGl2PgoKICAgIDxkaXYgaWQ9InBlcnNvblZpZXciIGNsYXNzPSJoaWRkZW4iPgogICAgICA8ZGl2IGNsYXNzPSJ0b3BiYXIiPgogICAgICAgIDxkaXY+CiAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJiYWNrIiBpZD0iYmFja0J0biI+4oaQIM6gzq/Pg8+JPC9idXR0b24+CiAgICAgICAgICA8ZGl2IGNsYXNzPSJoZWFkZXIiIHN0eWxlPSJtYXJnaW46NnB4IDAgMDsiPgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJsb2dvIiBzdHlsZT0id2lkdGg6MzRweDtoZWlnaHQ6MzRweDsiPjwvZGl2PgogICAgICAgICAgICA8ZGl2PgogICAgICAgICAgICAgIDxoMSBpZD0icGVyc29uVGl0bGUiIHN0eWxlPSJmb250LXNpemU6IGNsYW1wKDI0cHgsIDMuOHZ3LCAzOHB4KTsgbWFyZ2luOjA7Ij48L2gxPgogICAgICAgICAgICAgIDxwIGNsYXNzPSJzdWJ0aXRsZSIgc3R5bGU9Im1hcmdpbi10b3A6NnB4OyI+CiAgICAgICAgICAgICAgICDOo8+FzrzPgM67zq7Pgc+Jz4POtSDPhM65z4IgzrPPgc6xzrzOvM6tz4IuIM6Mz4TOsc69IM+Fz4DOrM+Bz4fOv8+Fzr0gPHN0cm9uZz7PhM6/z4XOu86sz4fOuc+Dz4TOv869IDI8L3N0cm9uZz4gz4PPhc68z4DOu863z4HPic68zq3Ovc6/zrkgz4TOr8+EzrvOv865IM+DzrUgzrzOuc6xIM66zrHPhM63zrPOv8+Bzq/OsSwKICAgICAgICAgICAgICAgIM68z4DOv8+BzrXOr8+CIM69zrEgzrrOrM69zrXOuc+CIGRyYWcgJiBkcm9wIM6zzrnOsSDOus6xz4TOrM+EzrHOvs63IM66zrHOuSDPhM6/IHNjb3JlIM61zr3Ot868zrXPgc+Ozr3Otc+EzrHOuSDOsc+Fz4TPjM68zrHPhM6xICgxzrc9MTIsIDLOtz0xMCwgM863PTgsIDTOtz03LCAuLi4pLgogICAgICAgICAgICAgIDwvcD4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICA8L2Rpdj4KICAgICAgICA8L2Rpdj4KICAgICAgICA8ZGl2IGNsYXNzPSJhY3Rpb25zIj4KICAgICAgICAgIDxkaXYgY2xhc3M9InBpbGwiIHRpdGxlPSJBdXRvc2F2ZSDPg861IGxvY2FsU3RvcmFnZSI+CiAgICAgICAgICAgIDxzcGFuPkF1dG9zYXZlOjwvc3Bhbj4gPHN0cm9uZz5PTjwvc3Ryb25nPgogICAgICAgICAgPC9kaXY+CiAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJhY3Rpb24iIGlkPSJyZXNldEFsbEJ0biI+UmVzZXQgz4zOu86xPC9idXR0b24+CiAgICAgICAgPC9kaXY+CiAgICAgIDwvZGl2PgoKICAgICAgPGRpdiBjbGFzcz0iIj4KICAgICAgICA8ZGl2IGNsYXNzPSJjYXJkIj4KICAgICAgICAgIDxkaXYgY2xhc3M9ImNhdHMiIGlkPSJjYXRlZ29yaWVzIj48L2Rpdj4KICAgICAgICA8L2Rpdj4KICAgICAgPC9kaXY+CgogICAgICA8ZGl2IGNsYXNzPSJoaW50Ij5UaXA6IM6kzr8gZHJhZyDOtc69zrXPgc6zzr/PgM6/zrnOtc6vz4TOsc65IM6xzr3OrCDOus6xz4TOt86zzr/Pgc6vzrEgz4zPhM6xzr0gz4XPgM6sz4HPh86/z4XOvSDPhM6/z4XOu86sz4fOuc+Dz4TOv869IDIgz4PPhc68z4DOu863z4HPic68zq3Ovc6/zrkgz4TOr8+EzrvOv865LiDOpM6xIHNjb3JlcyDOvM+AzrHOr869zr/Phc69IM68z4zOvc6/IM+Dz4TOuc+CIM+Dz4XOvM+AzrvOt8+Bz4nOvM6tzr3Otc+CIM6zz4HOsc68zrzOrc+CLjwvZGl2PgogICAgPC9kaXY+CiAgPC9kaXY+Cgo8c2NyaXB0IHNyYz0iaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L25wbS94bHN4QDAuMTguNS9kaXN0L3hsc3guZnVsbC5taW4uanMiPjwvc2NyaXB0Pgo8c2NyaXB0PgooKCkgPT4gewogIGNvbnN0IFBFT1BMRSA9IFsKICAgIHsgbGFiZWw6ICJUZXJpIFZpIFNlbnRpbyIsIHNsdWc6ICJ0ZXJpLXZpLXNlbnRpbyIgfSwKICAgIHsgbGFiZWw6ICJNb25oaWEiLCBzbHVnOiAibW9uaGlhIiB9LAogICAgeyBsYWJlbDogIkxpc2phbnNpIiwgc2x1ZzogImxpc2phbnNpIiB9LAogIF07CgogIGNvbnN0IENBVEVHT1JJRVMgPSBbCiAgICAiQmVzdCBnciBzb25nIiwKICAgICJCZXN0IGZvcmVpZ24gc29uZyIsCiAgICAiQmVzdCBHUiBNYWxlIEFydGlzdCIsCiAgICAiQmVzdCBHUiBGZW1hbGUgQXJ0c2lzIiwKICAgICJCZXN0IEZvcmVpZ24gTWFsZSBBcnRpc3QiLAogICAgIkJlc3QgRm9yZWlnbiBGZW1hbGUgQXJ0aXN0IiwKICAgICJCZXN0IEdSIG11c2ljIFZpZGVvIiwKICAgICJCZXN0IEZvcmVpZ24gTXVzaWMgVmlkZW8iLAogICAgIkJlc3QgRVNDIDIwMjUgcGVyZm9tYW5jZSIsCiAgICAiQmVzdCBBbGJ1bSBvZiB0aGUgWWVhciIsCiAgXTsKCiAgLy8gU2NvcmluZyBmb3IgdXAgdG8gMTAgcmFua2VkIGl0ZW1zIChhcHBsaWVzIHRvIGZpbGxlZCByb3dzIG9ubHkpCiAgY29uc3QgU0NPUkVTID0gWzEyLCAxMCwgOCwgNywgNiwgNSwgNCwgMywgMiwgMV07CgogIGNvbnN0IHFzID0gKHNlbCwgZWw9ZG9jdW1lbnQpID0+IGVsLnF1ZXJ5U2VsZWN0b3Ioc2VsKTsKCiAgY29uc3QgaG9tZVZpZXcgPSBxcygiI2hvbWVWaWV3Iik7CiAgY29uc3QgcGVyc29uVmlldyA9IHFzKCIjcGVyc29uVmlldyIpOwogIGNvbnN0IHBlb3BsZUdyaWQgPSBxcygiI3Blb3BsZUdyaWQiKTsKICBjb25zdCBjYXRlZ29yaWVzRWwgPSBxcygiI2NhdGVnb3JpZXMiKTsKICBjb25zdCBwZXJzb25UaXRsZSA9IHFzKCIjcGVyc29uVGl0bGUiKTsKICBjb25zdCBiYWNrQnRuID0gcXMoIiNiYWNrQnRuIik7CiAgY29uc3QgcmVzZXRBbGxCdG4gPSBxcygiI3Jlc2V0QWxsQnRuIik7CgogIGxldCBjdXJyZW50UGVyc29uID0gbnVsbDsKICBsZXQgc3RhdGUgPSBudWxsOyAvLyB7IFtjYXRlZ29yeV06IFsge2lkLHRleHR9IC4uLiBdIH0KICBsZXQgZHJhZ0N0eCA9IHsgY2F0OiBudWxsLCBkcmFnZ2luZ0lkOiBudWxsIH07CgogIC8vIEV4Y2VsIGltcG9ydCAocGVyIHBlcnNvbikKICBsZXQgcGVuZGluZ0ltcG9ydFBlcnNvbiA9IG51bGw7CgogIGNvbnN0IGV4Y2VsSW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJpbnB1dCIpOwogIGV4Y2VsSW5wdXQudHlwZSA9ICJmaWxlIjsKICBleGNlbElucHV0LmFjY2VwdCA9ICIueGxzeCwueGxzIjsKICBleGNlbElucHV0LmNsYXNzTmFtZSA9ICJoaWRkZW4iOwogIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZXhjZWxJbnB1dCk7CgogIGV4Y2VsSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcigiY2hhbmdlIiwgYXN5bmMgKCkgPT4gewogICAgY29uc3QgZmlsZSA9IGV4Y2VsSW5wdXQuZmlsZXMgJiYgZXhjZWxJbnB1dC5maWxlc1swXTsKICAgIGV4Y2VsSW5wdXQudmFsdWUgPSAiIjsgLy8gcmVzZXQgc28gdGhlIHNhbWUgZmlsZSBjYW4gYmUgcGlja2VkIGFnYWluCiAgICBpZiAoIWZpbGUgfHwgIXBlbmRpbmdJbXBvcnRQZXJzb24pIHJldHVybjsKICAgIHRyeXsKICAgICAgYXdhaXQgaW1wb3J0RXhjZWxGb3JQZXJzb24oZmlsZSwgcGVuZGluZ0ltcG9ydFBlcnNvbik7CiAgICAgIGFsZXJ0KGDOiM6zzrnOvc61IM+Dz4XOs8+Hz4HOv869zrnPg868z4zPgiDOs865zrE6ICR7cGVuZGluZ0ltcG9ydFBlcnNvbi5sYWJlbH1gKTsKICAgIH1jYXRjaChlcnIpewogICAgICBjb25zb2xlLmVycm9yKGVycik7CiAgICAgIGFsZXJ0KCLOkc+Azr/PhM+Fz4fOr86xIM+Dz4XOs8+Hz4HOv869zrnPg868zr/PjS4gzpLOtc6yzrHOuc+Oz4POv8+FIM+Mz4TOuSDPhM6/IEV4Y2VsIM61zq/Ovc6xzrkgz4PPic+Dz4TPjCAoLnhsc3gpIM66zrHOuSDOtM6/zrrOr868zrHPg861IM6+zrHOvc6sLiIpOwogICAgfWZpbmFsbHl7CiAgICAgIHBlbmRpbmdJbXBvcnRQZXJzb24gPSBudWxsOwogICAgfQogIH0pOwoKICBmdW5jdGlvbiBzdGFydEV4Y2VsSW1wb3J0Rm9yKHBlcnNvbil7CiAgICBpZiAodHlwZW9mIFhMU1ggPT09ICJ1bmRlZmluZWQiKXsKICAgICAgYWxlcnQoIs6UzrXOvSDOss+Bzq3OuM63zrrOtSDOtyDOss65zrLOu865zr/OuM6uzrrOtyBYTFNYLiDOiM67zrXOs86+zrUgz4zPhM65IM6tz4fOtc65z4Igz4PPjc69zrTOtc+Dzrcgzq4gz4zPhM65IM+Gzr/Pgc+Ez47Ovc61z4TOsc65IM+Dz4nPg8+Ezqwgz4TOvyB4bHN4LmZ1bGwubWluLmpzLiIpOwogICAgICByZXR1cm47CiAgICB9CiAgICBwZW5kaW5nSW1wb3J0UGVyc29uID0gcGVyc29uOwogICAgZXhjZWxJbnB1dC5jbGljaygpOwogIH0KCiAgZnVuY3Rpb24gbm9ybShzKXsKICAgIHJldHVybiBTdHJpbmcocyA/PyAiIikKICAgICAgLnRvTG93ZXJDYXNlKCkKICAgICAgLnJlcGxhY2UoL1tcXHUyMDBCLVxcdTIwMERcXHVGRUZGXS9nLCAiIikKICAgICAgLnJlcGxhY2UoL1teYS16MC05zrEtz4nOrM6tzq7Or8+Mz43Pjs+Kz4vOkM6wXFxzXS9naSwgIiAiKQogICAgICAucmVwbGFjZSgvXFxzKy9nLCAiICIpCiAgICAgIC50cmltKCk7CiAgfQoKICBmdW5jdGlvbiBtYXBFeGNlbENhdGVnb3J5KHJhdyl7CiAgICBjb25zdCBuID0gbm9ybShyYXcpOwoKICAgIGZvciAoY29uc3QgYyBvZiBDQVRFR09SSUVTKXsKICAgICAgaWYgKG5vcm0oYykgPT09IG4pIHJldHVybiBjOwogICAgfQoKICAgIGlmIChuLmluY2x1ZGVzKCJiZXN0IGdyZWVrIHNvbmciKSB8fCBuLmluY2x1ZGVzKCJiZXN0IGdyIHNvbmciKSB8fCAobi5pbmNsdWRlcygizrXOu867zrfOvSIpICYmIG4uaW5jbHVkZXMoIs+Ez4HOsc6zzr/Phc60IikpKQogICAgICByZXR1cm4gIkJlc3QgZ3Igc29uZyI7CiAgICBpZiAobi5pbmNsdWRlcygiYmVzdCBmb3JlaWduIHNvbmciKSB8fCAobi5pbmNsdWRlcygizr7Otc69IikgJiYgbi5pbmNsdWRlcygiz4TPgc6xzrPOv8+FzrQiKSkpCiAgICAgIHJldHVybiAiQmVzdCBmb3JlaWduIHNvbmciOwoKICAgIGlmIChuLmluY2x1ZGVzKCJiZXN0IGdyZWVrIG1hbGUgYXJ0aXN0IikgfHwgbi5pbmNsdWRlcygiYmVzdCBnciBtYWxlIikgfHwgKG4uaW5jbHVkZXMoIs61zrvOu863zr0iKSAmJiBuLmluY2x1ZGVzKCLOsc69zrTPgSIpKSkKICAgICAgcmV0dXJuICJCZXN0IEdSIE1hbGUgQXJ0aXN0IjsKICAgIGlmIChuLmluY2x1ZGVzKCJiZXN0IGdyZWVrIGZlbWFsZSBhcnRpc3QiKSB8fCBuLmluY2x1ZGVzKCJiZXN0IGdyIGZlbWFsZSIpIHx8IChuLmluY2x1ZGVzKCLOtc67zrvOt869IikgJiYgbi5pbmNsdWRlcygizrPPhc69IikpKQogICAgICByZXR1cm4gIkJlc3QgR1IgRmVtYWxlIEFydHNpcyI7CgogICAgaWYgKG4uaW5jbHVkZXMoImJlc3QgZm9yZWlnbiBtYWxlIGFydGlzdCIpIHx8IG4uaW5jbHVkZXMoImJlc3QgZm9yZWlnbiBtYWxlIikgfHwgKG4uaW5jbHVkZXMoIs6+zrXOvSIpICYmIG4uaW5jbHVkZXMoIs6xzr3OtM+BIikpKQogICAgICByZXR1cm4gIkJlc3QgRm9yZWlnbiBNYWxlIEFydGlzdCI7CiAgICBpZiAobi5pbmNsdWRlcygiYmVzdCBmb3JlaWduIGZlbWFsZSBhcnRpc3QiKSB8fCBuLmluY2x1ZGVzKCJiZXN0IGZvcmVpZ24gZmVtYWxlIikgfHwgKG4uaW5jbHVkZXMoIs6+zrXOvSIpICYmIG4uaW5jbHVkZXMoIs6zz4XOvSIpKSkKICAgICAgcmV0dXJuICJCZXN0IEZvcmVpZ24gRmVtYWxlIEFydGlzdCI7CgogICAgaWYgKG4uaW5jbHVkZXMoImJlc3QgZ3JlZWsgbXVzaWMgdmlkZW8iKSB8fCBuLmluY2x1ZGVzKCJiZXN0IGdyIG11c2ljIHZpZGVvIikgfHwgKG4uaW5jbHVkZXMoIs61zrvOu863zr0iKSAmJiBuLmluY2x1ZGVzKCLOss65zr3PhM61IikpKQogICAgICByZXR1cm4gIkJlc3QgR1IgbXVzaWMgVmlkZW8iOwogICAgaWYgKG4uaW5jbHVkZXMoImJlc3QgZm9yZWlnbiBtdXNpYyB2aWRlbyIpIHx8IChuLmluY2x1ZGVzKCLOvs61zr0iKSAmJiBuLmluY2x1ZGVzKCLOss65zr3PhM61IikpKQogICAgICByZXR1cm4gIkJlc3QgRm9yZWlnbiBNdXNpYyBWaWRlbyI7CgogICAgaWYgKG4uaW5jbHVkZXMoImVzYyIpICYmIChuLmluY2x1ZGVzKCJwZXJmb3JtYW5jZSIpIHx8IG4uaW5jbHVkZXMoInBlcmZvbWFuY2UiKSB8fCBuLmluY2x1ZGVzKCJwZXJmIikpKQogICAgICByZXR1cm4gIkJlc3QgRVNDIDIwMjUgcGVyZm9tYW5jZSI7CgogICAgaWYgKG4uaW5jbHVkZXMoImFsYnVtIG9mIHRoZSB5ZWFyIikgfHwgbiA9PT0gImFsYnVtIiB8fCBuLmluY2x1ZGVzKCLOrM67zrzPgCIpKQogICAgICByZXR1cm4gIkJlc3QgQWxidW0gb2YgdGhlIFllYXIiOwoKICAgIHJldHVybiBudWxsOwogIH0KCiAgZnVuY3Rpb24gc3RvcmFnZUtleShzbHVnKXsgcmV0dXJuIGBuZW9uLWF3YXJkczoke3NsdWd9YDsgfQoKICBmdW5jdGlvbiB1dWlkKCkgewogICAgaWYgKHR5cGVvZiBjcnlwdG8gIT09ICJ1bmRlZmluZWQiICYmIGNyeXB0by5yYW5kb21VVUlEKSByZXR1cm4gY3J5cHRvLnJhbmRvbVVVSUQoKTsKICAgIHJldHVybiBNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDE2KS5zbGljZSgyKSArICItIiArIERhdGUubm93KCkudG9TdHJpbmcoMTYpOwogIH0KCiAgZnVuY3Rpb24gbWFrZURlZmF1bHRTdGF0ZSgpewogICAgY29uc3Qgb2JqID0ge307CiAgICBmb3IgKGNvbnN0IGNhdCBvZiBDQVRFR09SSUVTKXsKICAgICAgb2JqW2NhdF0gPSBBcnJheS5mcm9tKHtsZW5ndGg6MTB9LCAoXyxpKSA9PiAoeyBpZDogYCR7Y2F0fV9fJHtpfV9fJHt1dWlkKCl9YCwgdGV4dDogIiIgfSkpOwogICAgfQogICAgcmV0dXJuIG9iajsKICB9CgogIGZ1bmN0aW9uIGVuc3VyZUNhdGVnb3J5TGVuZ3RoKHN0LCBjYXQsIGxlbil7CiAgICBpZiAoIUFycmF5LmlzQXJyYXkoc3RbY2F0XSkgfHwgc3RbY2F0XS5sZW5ndGggPCAxKXsKICAgICAgc3RbY2F0XSA9IEFycmF5LmZyb20oe2xlbmd0aDoxMH0sIChfLGkpID0+ICh7IGlkOiBgJHtjYXR9X18ke2l9X18ke3V1aWQoKX1gLCB0ZXh0OiAiIiB9KSk7CiAgICB9CiAgICBjb25zdCBjdXIgPSBzdFtjYXRdLmxlbmd0aDsKCiAgICBpZiAobGVuID4gY3VyKXsKICAgICAgZm9yIChsZXQgaT1jdXI7IGk8bGVuOyBpKyspewogICAgICAgIHN0W2NhdF0ucHVzaCh7IGlkOiBgJHtjYXR9X18ke2l9X18ke3V1aWQoKX1gLCB0ZXh0OiAiIiB9KTsKICAgICAgfQogICAgICByZXR1cm47CiAgICB9CgogICAgaWYgKGxlbiA8IGN1cil7CiAgICAgIGNvbnN0IHRhaWxIYXNUZXh0ID0gc3RbY2F0XS5zbGljZShsZW4pLnNvbWUociA9PiAoci50ZXh0IHx8ICIiKS50cmltKCkubGVuZ3RoID4gMCk7CiAgICAgIGlmICghdGFpbEhhc1RleHQpewogICAgICAgIHN0W2NhdF0gPSBzdFtjYXRdLnNsaWNlKDAsIGxlbik7CiAgICAgIH0KICAgIH0KICB9CgogIGZ1bmN0aW9uIGxvYWRTdGF0ZShzbHVnKXsKICAgIHRyeXsKICAgICAgY29uc3QgcmF3ID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oc3RvcmFnZUtleShzbHVnKSk7CiAgICAgIGlmICghcmF3KSByZXR1cm4gbWFrZURlZmF1bHRTdGF0ZSgpOwogICAgICBjb25zdCBwYXJzZWQgPSBKU09OLnBhcnNlKHJhdyk7CgogICAgICBmb3IgKGNvbnN0IGNhdCBvZiBDQVRFR09SSUVTKXsKICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkocGFyc2VkPy5bY2F0XSkgfHwgcGFyc2VkW2NhdF0ubGVuZ3RoIDwgMSl7CiAgICAgICAgICBwYXJzZWRbY2F0XSA9IEFycmF5LmZyb20oe2xlbmd0aDoxMH0sIChfLGkpID0+ICh7IGlkOiBgJHtjYXR9X18ke2l9X18ke3V1aWQoKX1gLCB0ZXh0OiAiIiB9KSk7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CiAgICAgICAgcGFyc2VkW2NhdF0gPSBwYXJzZWRbY2F0XS5tYXAoKHIsaSkgPT4gKHsKICAgICAgICAgIGlkOiBTdHJpbmcocj8uaWQgfHwgYCR7Y2F0fV9fJHtpfV9fJHt1dWlkKCl9YCksCiAgICAgICAgICB0ZXh0OiBTdHJpbmcocj8udGV4dCA/PyAiIikKICAgICAgICB9KSk7CiAgICAgIH0KICAgICAgcmV0dXJuIHBhcnNlZDsKICAgIH1jYXRjaHsKICAgICAgcmV0dXJuIG1ha2VEZWZhdWx0U3RhdGUoKTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIHNhdmVTdGF0ZSgpewogICAgdHJ5ewogICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShzdG9yYWdlS2V5KGN1cnJlbnRQZXJzb24uc2x1ZyksIEpTT04uc3RyaW5naWZ5KHN0YXRlKSk7CiAgICB9Y2F0Y2h7fQogIH0KCiAgZnVuY3Rpb24gaGFzVGV4dFJvdyhyKXsKICAgIHJldHVybiAoci50ZXh0IHx8ICIiKS50cmltKCkubGVuZ3RoID4gMDsKICB9CgogIGZ1bmN0aW9uIGZpbGxlZENvdW50KGNhdCl7CiAgICByZXR1cm4gc3RhdGVbY2F0XS5maWx0ZXIoaGFzVGV4dFJvdykubGVuZ3RoOwogIH0KCiAgLy8g4pyFIERyYWcgJiBkcm9wICsgcmFua2luZyBhY3RpdmF0ZSB3aXRoIGF0IGxlYXN0IDIgZmlsbGVkIHJvd3MKICBmdW5jdGlvbiBpc0RyYWdFbmFibGVkKGNhdCl7CiAgICByZXR1cm4gZmlsbGVkQ291bnQoY2F0KSA+PSAyOwogIH0KCiAgYXN5bmMgZnVuY3Rpb24gaW1wb3J0RXhjZWxGb3JQZXJzb24oZmlsZSwgcGVyc29uKXsKICAgIGNvbnN0IGJ1ZiA9IGF3YWl0IGZpbGUuYXJyYXlCdWZmZXIoKTsKICAgIGNvbnN0IHdiID0gWExTWC5yZWFkKGJ1ZiwgeyB0eXBlOiAiYXJyYXkiIH0pOwogICAgY29uc3Qgc2hlZXROYW1lID0gd2IuU2hlZXROYW1lcz8uWzBdOwogICAgaWYgKCFzaGVldE5hbWUpIHRocm93IG5ldyBFcnJvcigiTm8gc2hlZXRzIik7CiAgICBjb25zdCB3cyA9IHdiLlNoZWV0c1tzaGVldE5hbWVdOwoKICAgIGNvbnN0IHJvd3MgPSBYTFNYLnV0aWxzLnNoZWV0X3RvX2pzb24od3MsIHsgaGVhZGVyOiAxLCByYXc6IGZhbHNlLCBkZWZ2YWw6ICIiIH0pOwogICAgaWYgKCFyb3dzIHx8IHJvd3MubGVuZ3RoIDwgMikgdGhyb3cgbmV3IEVycm9yKCJFbXB0eSBzaGVldCIpOwoKICAgIGNvbnN0IGhlYWRlciA9IHJvd3NbMF0ubWFwKHggPT4gU3RyaW5nKHggPz8gIiIpKTsKICAgIGNvbnN0IGhlYWRlck4gPSBoZWFkZXIubWFwKG5vcm0pOwoKICAgIGxldCBjYXRJZHggPSBoZWFkZXJOLmZpbmRJbmRleChoID0+IGggPT09ICLOus6xz4TOt86zzr/Pgc6vzrEiIHx8IGggPT09ICJjYXRlZ29yeSIpOwogICAgbGV0IHBvc0lkeCA9IGhlYWRlck4uZmluZEluZGV4KGggPT4gaCA9PT0gIs64zq3Pg863IiB8fCBoID09PSAizrjOtc+DzrciIHx8IGggPT09ICJwb3NpdGlvbiIgfHwgaCA9PT0gInJhbmsiKTsKICAgIGlmIChjYXRJZHggPCAwKSBjYXRJZHggPSAwOwogICAgaWYgKHBvc0lkeCA8IDApIHBvc0lkeCA9IDE7CgogICAgbGV0IHBlcnNvbklkeCA9IC0xOwogICAgY29uc3QgbGFiZWxOID0gbm9ybShwZXJzb24ubGFiZWwpOwogICAgZm9yIChsZXQgaT0wO2k8aGVhZGVyTi5sZW5ndGg7aSsrKXsKICAgICAgaWYgKGhlYWRlck5baV0gPT09IGxhYmVsTikgeyBwZXJzb25JZHggPSBpOyBicmVhazsgfQogICAgfQogICAgaWYgKHBlcnNvbklkeCA8IDApewogICAgICBpZiAoaGVhZGVyLmxlbmd0aCA9PT0gMykgcGVyc29uSWR4ID0gMjsKICAgICAgZWxzZSBwZXJzb25JZHggPSBNYXRoLm1heChwb3NJZHggKyAxLCAyKTsKICAgIH0KCiAgICBjb25zdCBpbXBvcnRlZFN0YXRlID0gbG9hZFN0YXRlKHBlcnNvbi5zbHVnKTsKCiAgICBsZXQgY3VycmVudENhdFJhdyA9ICIiOwogICAgZm9yIChsZXQgciA9IDE7IHIgPCByb3dzLmxlbmd0aDsgcisrKXsKICAgICAgY29uc3Qgcm93ID0gcm93c1tyXTsKICAgICAgY29uc3QgY2F0Q2VsbCA9IHJvd1tjYXRJZHhdOwogICAgICBpZiAoU3RyaW5nKGNhdENlbGwgPz8gIiIpLnRyaW0oKS5sZW5ndGggPiAwKXsKICAgICAgICBjdXJyZW50Q2F0UmF3ID0gU3RyaW5nKGNhdENlbGwpLnRyaW0oKTsKICAgICAgfQogICAgICBjb25zdCBtYXBwZWRDYXQgPSBtYXBFeGNlbENhdGVnb3J5KGN1cnJlbnRDYXRSYXcpOwogICAgICBpZiAoIW1hcHBlZENhdCkgY29udGludWU7CgogICAgICBjb25zdCBwb3MgPSBOdW1iZXIocm93W3Bvc0lkeF0pOwogICAgICBpZiAoIU51bWJlci5pc0Zpbml0ZShwb3MpIHx8IHBvcyA8IDEpIGNvbnRpbnVlOwoKICAgICAgZW5zdXJlQ2F0ZWdvcnlMZW5ndGgoaW1wb3J0ZWRTdGF0ZSwgbWFwcGVkQ2F0LCBNYXRoLm1heChpbXBvcnRlZFN0YXRlW21hcHBlZENhdF0ubGVuZ3RoLCBwb3MpKTsKCiAgICAgIGNvbnN0IHZhbHVlID0gU3RyaW5nKHJvd1twZXJzb25JZHhdID8/ICIiKS50cmltKCk7CiAgICAgIGlmICh2YWx1ZS5sZW5ndGggPiAwKXsKICAgICAgICBpbXBvcnRlZFN0YXRlW21hcHBlZENhdF1bcG9zLTFdLnRleHQgPSB2YWx1ZTsKICAgICAgfQogICAgfQoKICAgIHRyeXsKICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oc3RvcmFnZUtleShwZXJzb24uc2x1ZyksIEpTT04uc3RyaW5naWZ5KGltcG9ydGVkU3RhdGUpKTsKICAgIH1jYXRjaHt9CgogICAgaWYgKGN1cnJlbnRQZXJzb24/LnNsdWcgPT09IHBlcnNvbi5zbHVnKXsKICAgICAgc3RhdGUgPSBpbXBvcnRlZFN0YXRlOwogICAgICByZW5kZXJDYXRlZ29yaWVzKCk7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBzaG93SG9tZSgpewogICAgY3VycmVudFBlcnNvbiA9IG51bGw7CiAgICBzdGF0ZSA9IG51bGw7CiAgICBwZXJzb25WaWV3LmNsYXNzTGlzdC5hZGQoImhpZGRlbiIpOwogICAgaG9tZVZpZXcuY2xhc3NMaXN0LnJlbW92ZSgiaGlkZGVuIik7CiAgICBoaXN0b3J5LnJlcGxhY2VTdGF0ZShudWxsLCAiIiwgbG9jYXRpb24ucGF0aG5hbWUgKyBsb2NhdGlvbi5zZWFyY2ggKyAiIy8iKTsKICB9CgogIGZ1bmN0aW9uIHNob3dQZXJzb24oc2x1Zyl7CiAgICBjb25zdCBwID0gUEVPUExFLmZpbmQoeCA9PiB4LnNsdWcgPT09IHNsdWcpOwogICAgaWYgKCFwKSByZXR1cm4gc2hvd0hvbWUoKTsKICAgIGN1cnJlbnRQZXJzb24gPSBwOwogICAgc3RhdGUgPSBsb2FkU3RhdGUoc2x1Zyk7CiAgICBob21lVmlldy5jbGFzc0xpc3QuYWRkKCJoaWRkZW4iKTsKICAgIHBlcnNvblZpZXcuY2xhc3NMaXN0LnJlbW92ZSgiaGlkZGVuIik7CiAgICBwZXJzb25UaXRsZS50ZXh0Q29udGVudCA9IHAubGFiZWw7CiAgICByZW5kZXJDYXRlZ29yaWVzKCk7CiAgICBoaXN0b3J5LnJlcGxhY2VTdGF0ZShudWxsLCAiIiwgbG9jYXRpb24ucGF0aG5hbWUgKyBsb2NhdGlvbi5zZWFyY2ggKyAiIy8iICsgc2x1Zyk7CiAgfQoKICBmdW5jdGlvbiByZW5kZXJIb21lQnV0dG9ucygpewogICAgcGVvcGxlR3JpZC5pbm5lckhUTUwgPSAiIjsKCiAgICBmb3IgKGNvbnN0IHAgb2YgUEVPUExFKXsKICAgICAgY29uc3QgdGlsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgICB0aWxlLmNsYXNzTmFtZSA9ICJwZXJzb24tdGlsZSI7CgogICAgICBjb25zdCBidG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJidXR0b24iKTsKICAgICAgYnRuLmNsYXNzTmFtZSA9ICJwZXJzb24tYnRuIjsKICAgICAgYnRuLnR5cGUgPSAiYnV0dG9uIjsKICAgICAgYnRuLmlubmVySFRNTCA9IGAKICAgICAgICA8ZGl2IGNsYXNzPSJwZXJzb24tdGl0bGUiPiR7ZXNjYXBlSHRtbChwLmxhYmVsKX08L2Rpdj4KICAgICAgICA8ZGl2IGNsYXNzPSJwZXJzb24tc3ViIj7Ohs69zr/Ouc6zzrzOsSDPg861zrvOr860zrHPgjwvZGl2PgogICAgICBgOwogICAgICBidG4uYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCAoKSA9PiB7CiAgICAgICAgY29uc3QgUElOUyA9IHsKICAgICAgICAgICJ0ZXJpLXZpLXNlbnRpbyI6ICIxNDc4IiwKICAgICAgICAgICJtb25oaWEiOiAiOTYzMiIsCiAgICAgICAgICAibGlzamFuc2kiOiAiMjM2NSIKICAgICAgICB9OwogICAgICAgIGNvbnN0IGV4cGVjdGVkID0gUElOU1twLnNsdWddOwogICAgICAgIGlmIChleHBlY3RlZCl7CiAgICAgICAgICBjb25zdCBwaW4gPSBwcm9tcHQoIs6VzrnPg86szrPOtc+EzrUgUElOIM6zzrnOsSDPgM+Bz4zPg86yzrHPg863OiIpOwogICAgICAgICAgaWYgKHBpbiAhPT0gZXhwZWN0ZWQpewogICAgICAgICAgICBhbGVydCgizpvOrM64zr/PgiBQSU4uIM6UzrXOvSDOtc+AzrnPhM+Bzq3PgM61z4TOsc65IM63IM+Az4HPjM+DzrLOsc+DzrcuIik7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgc2hvd1BlcnNvbihwLnNsdWcpOwogICAgICB9KTtjb25zdCBzeW5jID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiYnV0dG9uIik7CiAgICAgIHN5bmMuY2xhc3NOYW1lID0gInN5bmMtbWluaSI7CiAgICAgIHN5bmMudHlwZSA9ICJidXR0b24iOwogICAgICBzeW5jLnRpdGxlID0gIs6jz4XOs8+Hz4HOv869zrnPg868z4zPgiDOsc+Az4wgRXhjZWwgKC54bHN4KSI7CiAgICAgIHN5bmMudGV4dENvbnRlbnQgPSAi4p+zIEV4Y2VsIjsKICAgICAgc3luYy5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsIChlKSA9PiB7CiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgICAgc3RhcnRFeGNlbEltcG9ydEZvcihwKTsKICAgICAgfSk7CgogICAgICB0aWxlLmFwcGVuZENoaWxkKGJ0bik7CiAgICAgIHRpbGUuYXBwZW5kQ2hpbGQoc3luYyk7CiAgICAgIHBlb3BsZUdyaWQuYXBwZW5kQ2hpbGQodGlsZSk7CiAgICB9CiAgfQoKICBmdW5jdGlvbiByZW5kZXJDYXRlZ29yaWVzKCl7CiAgICBjYXRlZ29yaWVzRWwuaW5uZXJIVE1MID0gIiI7CgogICAgZm9yIChjb25zdCBjYXQgb2YgQ0FURUdPUklFUyl7CiAgICAgIGNvbnN0IGNvdW50ID0gZmlsbGVkQ291bnQoY2F0KTsKICAgICAgY29uc3QgZHJhZ09uID0gaXNEcmFnRW5hYmxlZChjYXQpOwoKICAgICAgc3RhdGVbY2F0XSA9IFsuLi5zdGF0ZVtjYXRdLmZpbHRlcihoYXNUZXh0Um93KSwgLi4uc3RhdGVbY2F0XS5maWx0ZXIociA9PiAhaGFzVGV4dFJvdyhyKSldOwoKICAgICAgY29uc3QgY2F0Q2FyZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgICBjYXRDYXJkLmNsYXNzTmFtZSA9ICJjYXQiOwogICAgICBjYXRDYXJkLmRhdGFzZXQuY2F0ID0gY2F0OwoKICAgICAgY29uc3QgaGVhZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgICBoZWFkLmNsYXNzTmFtZSA9ICJjYXQtaGVhZCI7CiAgICAgIGhlYWQuaW5uZXJIVE1MID0gYAogICAgICAgIDxkaXY+CiAgICAgICAgICA8aDI+JHtlc2NhcGVIdG1sKGNhdCl9PC9oMj4KICAgICAgICAgIDxkaXYgY2xhc3M9InN0YXR1cyAke2RyYWdPbiA/ICJvbiIgOiAiIn0iPgogICAgICAgICAgICAke2RyYWdPbiA/IGBEcmFnICYgZHJvcDogT04gKCR7Y291bnR9IM+Ezq/PhM67zr/OuSlgIDogYERyYWcgJiBkcm9wOiBPRkYgKM6yzqzOu861IM+Ezr/Phc67zqzPh865z4PPhM6/zr0gMiDPhM6vz4TOu86/z4XPgiDigJQgz4TPjs+BzrEgzq3Ph861zrkgJHtjb3VudH0pYH0KICAgICAgICAgIDwvZGl2PgogICAgICAgIDwvZGl2PgogICAgICBgOwoKICAgICAgY29uc3QgY2xlYXJCdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJidXR0b24iKTsKICAgICAgY2xlYXJCdG4uY2xhc3NOYW1lID0gIm1pbmkiOwogICAgICBjbGVhckJ0bi50eXBlID0gImJ1dHRvbiI7CiAgICAgIGNsZWFyQnRuLnRleHRDb250ZW50ID0gIkNsZWFyIjsKICAgICAgY2xlYXJCdG4udGl0bGUgPSAizprOsc64zqzPgc65z4POvM6xIM68z4zOvc6/IM6xz4XPhM6uz4Igz4TOt8+CIM66zrHPhM63zrPOv8+Bzq/Osc+CIjsKICAgICAgY2xlYXJCdG4uYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCAoKSA9PiB7CiAgICAgICAgc3RhdGVbY2F0XSA9IHN0YXRlW2NhdF0ubWFwKHIgPT4gKHsuLi5yLCB0ZXh0OiIifSkpOwogICAgICAgIHNhdmVTdGF0ZSgpOwogICAgICAgIHJlbmRlckNhdGVnb3JpZXMoKTsKICAgICAgfSk7CiAgICAgIGhlYWQuYXBwZW5kQ2hpbGQoY2xlYXJCdG4pOwoKICAgICAgY29uc3QgbGlzdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgICBsaXN0LmNsYXNzTmFtZSA9ICJsaXN0IjsKICAgICAgbGlzdC5kYXRhc2V0LmNhdCA9IGNhdDsKCiAgICAgIHN0YXRlW2NhdF0uZm9yRWFjaCgocm93LCBpZHgpID0+IHsKICAgICAgICBjb25zdCByb3dFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgICAgIGNvbnN0IHJvd0ZpbGxlZCA9IGhhc1RleHRSb3cocm93KTsKICAgICAgICByb3dFbC5jbGFzc05hbWUgPSAicm93IiArIChkcmFnT24gPyAiIGRyYWctZW5hYmxlZCIgOiAiIik7CiAgICAgICAgcm93RWwuZGF0YXNldC5pZCA9IHJvdy5pZDsKICAgICAgICByb3dFbC5kcmFnZ2FibGUgPSBkcmFnT24gJiYgcm93RmlsbGVkOwoKICAgICAgICBjb25zdCBoYW5kbGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgICAgICBoYW5kbGUuY2xhc3NOYW1lID0gImhhbmRsZSIgKyAoZHJhZ09uICYmIHJvd0ZpbGxlZCA/ICIiIDogIiBvZmYiKTsKICAgICAgICBoYW5kbGUudGV4dENvbnRlbnQgPSAi4piwIjsKICAgICAgICBoYW5kbGUudGl0bGUgPSAoZHJhZ09uICYmIHJvd0ZpbGxlZCkKICAgICAgICAgID8gIkRyYWciCiAgICAgICAgICA6ICLOp8+BzrXOuc6szrbOv869z4TOsc65IM+Ezr/Phc67zqzPh865z4PPhM6/zr0gMiDPg8+FzrzPgM67zrfPgc+JzrzOrc69zr/OuSDPhM6vz4TOu86/zrkgKM66zrHOuSDPhM6/IM+Dz4XOs866zrXOus+BzrnOvM6tzr3OvyDPgM61zrTOr86/IM69zrEgzrXOr869zrHOuSDPg8+FzrzPgM67zrfPgc+JzrzOrc69zr8pIjsKCiAgICAgICAgY29uc3QgbnVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICAgICAgbnVtLmNsYXNzTmFtZSA9ICJudW0iOwogICAgICAgIG51bS50ZXh0Q29udGVudCA9IFN0cmluZyhpZHggKyAxKTsKCiAgICAgICAgY29uc3Qgc2NvcmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgICAgICBzY29yZS5jbGFzc05hbWUgPSAic2NvcmUiOwogICAgICAgIGNvbnN0IGJhZGdlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICAgICAgYmFkZ2UuY2xhc3NOYW1lID0gImJhZGdlIjsKICAgICAgICBiYWRnZS50ZXh0Q29udGVudCA9IHJvd0ZpbGxlZCA/IFN0cmluZygoU0NPUkVTW2lkeF0gPz8gMCkpIDogIiI7CiAgICAgICAgc2NvcmUuYXBwZW5kQ2hpbGQoYmFkZ2UpOwoKICAgICAgICBjb25zdCBpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImlucHV0Iik7CiAgICAgICAgaW5wdXQuY2xhc3NOYW1lID0gInRleHQiOwogICAgICAgIGlucHV0LnR5cGUgPSAidGV4dCI7CiAgICAgICAgaW5wdXQucGxhY2Vob2xkZXIgPSAizpPPgc6sz4jOtSDOtc60z44uLi4iOwogICAgICAgIGlucHV0LnZhbHVlID0gcm93LnRleHQgfHwgIiI7CiAgICAgICAgaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcigiaW5wdXQiLCAoZSkgPT4gewogICAgICAgICAgcm93LnRleHQgPSBlLnRhcmdldC52YWx1ZTsKICAgICAgICAgIHNhdmVTdGF0ZSgpOwogICAgICAgICAgcmVuZGVyQ2F0ZWdvcmllcygpOwogICAgICAgIH0pOwoKICAgICAgICByb3dFbC5hZGRFdmVudExpc3RlbmVyKCJkcmFnc3RhcnQiLCAoZSkgPT4gewogICAgICAgICAgaWYgKCFpc0RyYWdFbmFibGVkKGNhdCkgfHwgIWhhc1RleHRSb3cocm93KSkgeyBlLnByZXZlbnREZWZhdWx0KCk7IHJldHVybjsgfQogICAgICAgICAgZHJhZ0N0eC5jYXQgPSBjYXQ7CiAgICAgICAgICBkcmFnQ3R4LmRyYWdnaW5nSWQgPSByb3cuaWQ7CiAgICAgICAgICByb3dFbC5jbGFzc0xpc3QuYWRkKCJkcmFnZ2luZyIpOwogICAgICAgICAgZS5kYXRhVHJhbnNmZXIuZWZmZWN0QWxsb3dlZCA9ICJtb3ZlIjsKICAgICAgICAgIGUuZGF0YVRyYW5zZmVyLnNldERhdGEoInRleHQvcGxhaW4iLCByb3cuaWQpOwogICAgICAgIH0pOwoKICAgICAgICByb3dFbC5hZGRFdmVudExpc3RlbmVyKCJkcmFnZW5kIiwgKCkgPT4gewogICAgICAgICAgcm93RWwuY2xhc3NMaXN0LnJlbW92ZSgiZHJhZ2dpbmciKTsKICAgICAgICAgIGRyYWdDdHguY2F0ID0gbnVsbDsKICAgICAgICAgIGRyYWdDdHguZHJhZ2dpbmdJZCA9IG51bGw7CiAgICAgICAgfSk7CgogICAgICAgIHJvd0VsLmFkZEV2ZW50TGlzdGVuZXIoImRyYWdvdmVyIiwgKGUpID0+IHsKICAgICAgICAgIGlmICghaXNEcmFnRW5hYmxlZChjYXQpKSByZXR1cm47CiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICBlLmRhdGFUcmFuc2Zlci5kcm9wRWZmZWN0ID0gIm1vdmUiOwogICAgICAgIH0pOwoKICAgICAgICByb3dFbC5hZGRFdmVudExpc3RlbmVyKCJkcm9wIiwgKGUpID0+IHsKICAgICAgICAgIGlmICghaXNEcmFnRW5hYmxlZChjYXQpKSByZXR1cm47CiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CgogICAgICAgICAgY29uc3QgZnJvbUlkID0gZS5kYXRhVHJhbnNmZXIuZ2V0RGF0YSgidGV4dC9wbGFpbiIpOwogICAgICAgICAgY29uc3QgdG9JZCA9IHJvdy5pZDsKICAgICAgICAgIGlmICghZnJvbUlkIHx8IGZyb21JZCA9PT0gdG9JZCkgcmV0dXJuOwogICAgICAgICAgaWYgKGRyYWdDdHguY2F0ICE9PSBjYXQpIHJldHVybjsKCiAgICAgICAgICBjb25zdCB0b1JvdyA9IHN0YXRlW2NhdF0uZmluZCh4ID0+IHguaWQgPT09IHRvSWQpOwogICAgICAgICAgaWYgKCF0b1JvdyB8fCAhaGFzVGV4dFJvdyh0b1JvdykpIHJldHVybjsKCiAgICAgICAgICBjb25zdCBhcnIgPSBzdGF0ZVtjYXRdOwogICAgICAgICAgY29uc3QgZnJvbUlkeCA9IGFyci5maW5kSW5kZXgoeCA9PiB4LmlkID09PSBmcm9tSWQpOwogICAgICAgICAgY29uc3QgdG9JZHggPSBhcnIuZmluZEluZGV4KHggPT4geC5pZCA9PT0gdG9JZCk7CiAgICAgICAgICBpZiAoZnJvbUlkeCA8IDAgfHwgdG9JZHggPCAwKSByZXR1cm47CgogICAgICAgICAgY29uc3QgW2l0ZW1dID0gYXJyLnNwbGljZShmcm9tSWR4LCAxKTsKICAgICAgICAgIGFyci5zcGxpY2UodG9JZHgsIDAsIGl0ZW0pOwoKICAgICAgICAgIHNhdmVTdGF0ZSgpOwogICAgICAgICAgcmVuZGVyQ2F0ZWdvcmllcygpOwogICAgICAgIH0pOwoKICAgICAgICByb3dFbC5hcHBlbmRDaGlsZChoYW5kbGUpOwogICAgICAgIHJvd0VsLmFwcGVuZENoaWxkKG51bSk7CiAgICAgICAgcm93RWwuYXBwZW5kQ2hpbGQoaW5wdXQpOwogICAgICAgIHJvd0VsLmFwcGVuZENoaWxkKHNjb3JlKTsKICAgICAgICBsaXN0LmFwcGVuZENoaWxkKHJvd0VsKTsKICAgICAgfSk7CgogICAgICBjYXRDYXJkLmFwcGVuZENoaWxkKGhlYWQpOwogICAgICBjYXRDYXJkLmFwcGVuZENoaWxkKGxpc3QpOwogICAgICBjYXRlZ29yaWVzRWwuYXBwZW5kQ2hpbGQoY2F0Q2FyZCk7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBlc2NhcGVIdG1sKHN0cil7CiAgICByZXR1cm4gU3RyaW5nKHN0cikKICAgICAgLnJlcGxhY2VBbGwoIiYiLCImYW1wOyIpCiAgICAgIC5yZXBsYWNlQWxsKCI8IiwiJmx0OyIpCiAgICAgIC5yZXBsYWNlQWxsKCI+IiwiJmd0OyIpCiAgICAgIC5yZXBsYWNlQWxsKCciJywiJnF1b3Q7IikKICAgICAgLnJlcGxhY2VBbGwoIiciLCImIzAzOTsiKTsKICB9CgogIGJhY2tCdG4uYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCBzaG93SG9tZSk7CgogIHJlc2V0QWxsQnRuLmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgKCkgPT4gewogICAgaWYgKCFjdXJyZW50UGVyc29uKSByZXR1cm47CiAgICBzdGF0ZSA9IG1ha2VEZWZhdWx0U3RhdGUoKTsKICAgIHNhdmVTdGF0ZSgpOwogICAgcmVuZGVyQ2F0ZWdvcmllcygpOwogIH0pOwoKICBmdW5jdGlvbiByb3V0ZSgpewogICAgY29uc3QgaCA9IGxvY2F0aW9uLmhhc2ggfHwgIiMvIjsKICAgIGNvbnN0IHBhcnRzID0gaC5yZXBsYWNlKC9eI1wvPy8sICIiKS5zcGxpdCgiLyIpLmZpbHRlcihCb29sZWFuKTsKICAgIGlmIChwYXJ0cy5sZW5ndGggPT09IDApIHNob3dIb21lKCk7CiAgICBlbHNlIHNob3dQZXJzb24ocGFydHNbMF0pOwogIH0KCiAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoImhhc2hjaGFuZ2UiLCByb3V0ZSk7CgogIHJlbmRlckhvbWVCdXR0b25zKCk7CiAgcm91dGUoKTsKCiAgLy8gPT09PT0gSmFtZXMgUmlnYXM6IFN0YXRpc3RpY3MgJiBFeGNlbCBFeHBvcnQgPT09PT0KICBjb25zdCBzdGF0c0J0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJzdGF0c0J0biIpOwoKICBmdW5jdGlvbiBjb2xsZWN0U3RhdGlzdGljcygpewogICAgY29uc3QgcmVzdWx0cyA9IFtdOwogICAgZm9yIChjb25zdCBwIG9mIFBFT1BMRSl7CiAgICAgIGNvbnN0IHN0ID0gbG9hZFN0YXRlKHAuc2x1Zyk7CiAgICAgIGZvciAoY29uc3QgY2F0IG9mIENBVEVHT1JJRVMpewogICAgICAgIGNvbnN0IHJvd3MgPSBzdFtjYXRdIHx8IFtdOwogICAgICAgIHJvd3MuZm9yRWFjaCgociwgaWR4KSA9PiB7CiAgICAgICAgICBpZiAoKHIudGV4dCB8fCAiIikudHJpbSgpLmxlbmd0aCA+IDApewogICAgICAgICAgICByZXN1bHRzLnB1c2goewogICAgICAgICAgICAgIHBlcnNvbjogcC5sYWJlbCwKICAgICAgICAgICAgICBjYXRlZ29yeTogY2F0LAogICAgICAgICAgICAgIHJhbms6IGlkeCArIDEsCiAgICAgICAgICAgICAgc2NvcmU6IFNDT1JFU1tpZHhdID8/IDAsCiAgICAgICAgICAgICAgdmFsdWU6IHIudGV4dAogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQogICAgfQogICAgcmV0dXJuIHJlc3VsdHM7CiAgfQoKICBmdW5jdGlvbiBleHBvcnRTdGF0c1RvRXhjZWwoKXsKICAgIGNvbnN0IHBpbiA9IHByb21wdCgizpXOuc+DzqzOs861z4TOtSDPhM6/zr0gzrrPic60zrnOus+MIM6zzrnOsSDOtc6+zrHOs8+JzrPOriBFeGNlbDoiKTsKICAgIGlmIChwaW4gIT09ICI3NDU2Iil7CiAgICAgIGFsZXJ0KCLOm86szrjOv8+CIM66z4nOtM65zrrPjM+CLiDOlyDOtc6+zrHOs8+JzrPOriDOsc66z4XPgc+OzrjOt866zrUuIik7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBjb25zdCBkYXRhID0gY29sbGVjdFN0YXRpc3RpY3MoKTsKICAgIGlmICghZGF0YS5sZW5ndGgpewogICAgICBhbGVydCgizpTOtc69IM+Fz4DOrM+Bz4fOv8+Fzr0gzrTOtc60zr/OvM6tzr3OsSDOs865zrEgzrXOvs6xzrPPic6zzq4uIik7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBjb25zdCB3c0RhdGEgPSBbCiAgICAgIFsiUGVyc29uIiwgIkNhdGVnb3J5IiwgIlJhbmsiLCAiU2NvcmUiLCAiQW5zd2VyIl0KICAgIF07CiAgICBkYXRhLmZvckVhY2goZCA9PiB7CiAgICAgIHdzRGF0YS5wdXNoKFtkLnBlcnNvbiwgZC5jYXRlZ29yeSwgZC5yYW5rLCBkLnNjb3JlLCBkLnZhbHVlXSk7CiAgICB9KTsKCiAgICBjb25zdCB3cyA9IFhMU1gudXRpbHMuYW9hX3RvX3NoZWV0KHdzRGF0YSk7CiAgICBjb25zdCB3YiA9IFhMU1gudXRpbHMuYm9va19uZXcoKTsKICAgIFhMU1gudXRpbHMuYm9va19hcHBlbmRfc2hlZXQod2IsIHdzLCAiU3RhdGlzdGljcyIpOwoKICAgIFhMU1gud3JpdGVGaWxlKHdiLCAiSmFtZXNfUmlnYXNfU3RhdGlzdGljcy54bHN4Iik7CiAgfQoKICBpZiAoc3RhdHNCdG4pewogICAgc3RhdHNCdG4uYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCBleHBvcnRTdGF0c1RvRXhjZWwpOwogIH0KCn0pKCk7Cjwvc2NyaXB0PgoKPHNjcmlwdD4KLy8gPT09PT0gSmFtZXMgUmlnYXM6IFBlci1wZXJzb24gUElOIEV4cG9ydCA9PT09PQpjb25zdCBQRVJTT05fUElOUyA9IHsKICAidGVyaS12aS1zZW50aW8iOiAiMTQ3OCIsCiAgIm1vbmhpYSI6ICI5NjMyIiwKICAibGlzamFuc2kiOiAiMjM2NSIKfTsKCmZ1bmN0aW9uIGV4cG9ydFN0YXRzVG9FeGNlbCgpewogIGNvbnN0IHBlcnNvblNsdWcgPSBwcm9tcHQoCiAgICAizqDOu863zrrPhM+Bzr/Ou8+MzrPOt8+DzrUgzqzPhM6/zrzOvyDOs865zrEgZXhwb3J0OlxuIiArCiAgICAidGVyaS12aS1zZW50aW9cbm1vbmhpYVxubGlzamFuc2kiCiAgKTsKCiAgaWYgKCFwZXJzb25TbHVnIHx8ICFQRVJTT05fUElOU1twZXJzb25TbHVnXSl7CiAgICBhbGVydCgizpzOtyDOrc6zzrrPhc+Bzr8gzqzPhM6/zrzOvy4gzpcgzrXOvs6xzrPPic6zzq4gzrHOus+Fz4HPjs64zrfOus61LiIpOwogICAgcmV0dXJuOwogIH0KCiAgY29uc3QgcGluID0gcHJvbXB0KCLOlc65z4POrM6zzrXPhM61IFBJTjoiKTsKICBpZiAocGluICE9PSBQRVJTT05fUElOU1twZXJzb25TbHVnXSl7CiAgICBhbGVydCgizpvOrM64zr/PgiBQSU4uIM6XIM61zr7Osc6zz4nOs86uIM6xzrrPhc+Bz47OuM63zrrOtS4iKTsKICAgIHJldHVybjsKICB9CgogIGNvbnN0IHN0ID0gbG9hZFN0YXRlKHBlcnNvblNsdWcpOwogIGNvbnN0IHBlcnNvbiA9IFBFT1BMRS5maW5kKHAgPT4gcC5zbHVnID09PSBwZXJzb25TbHVnKTsKCiAgY29uc3Qgcm93c091dCA9IFtdOwogIGZvciAoY29uc3QgY2F0IG9mIENBVEVHT1JJRVMpewogICAgY29uc3Qgcm93cyA9IHN0W2NhdF0gfHwgW107CiAgICByb3dzLmZvckVhY2goKHIsIGlkeCkgPT4gewogICAgICBpZiAoKHIudGV4dCB8fCAiIikudHJpbSgpLmxlbmd0aCA+IDApewogICAgICAgIHJvd3NPdXQucHVzaChbCiAgICAgICAgICBwZXJzb24ubGFiZWwsCiAgICAgICAgICBjYXQsCiAgICAgICAgICBpZHggKyAxLAogICAgICAgICAgU0NPUkVTW2lkeF0gPz8gMCwKICAgICAgICAgIHIudGV4dAogICAgICAgIF0pOwogICAgICB9CiAgICB9KTsKICB9CgogIGlmICghcm93c091dC5sZW5ndGgpewogICAgYWxlcnQoIs6UzrXOvSDPhc+AzqzPgc+Hzr/Phc69IM60zrXOtM6/zrzOrc69zrEgzrPOuc6xIM61zr7Osc6zz4nOs86uLiIpOwogICAgcmV0dXJuOwogIH0KCiAgY29uc3Qgd3NEYXRhID0gWwogICAgWyJQZXJzb24iLCAiQ2F0ZWdvcnkiLCAiUmFuayIsICJTY29yZSIsICJBbnN3ZXIiXSwKICAgIC4uLnJvd3NPdXQKICBdOwoKICBjb25zdCB3cyA9IFhMU1gudXRpbHMuYW9hX3RvX3NoZWV0KHdzRGF0YSk7CiAgY29uc3Qgd2IgPSBYTFNYLnV0aWxzLmJvb2tfbmV3KCk7CiAgWExTWC51dGlscy5ib29rX2FwcGVuZF9zaGVldCh3Yiwgd3MsIHBlcnNvbi5sYWJlbCk7CgogIFhMU1gud3JpdGVGaWxlKAogICAgd2IsCiAgICBwZXJzb24ubGFiZWwucmVwbGFjZSgvXHMrL2csICJfIikgKyAiX1N0YXRpc3RpY3MueGxzeCIKICApOwp9CgovLyByZWJpbmQgYnV0dG9uCmNvbnN0IHN0YXRzQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInN0YXRzQnRuIik7CmlmIChzdGF0c0J0bil7CiAgc3RhdHNCdG4ub25jbGljayA9IGV4cG9ydFN0YXRzVG9FeGNlbDsKfQo8L3NjcmlwdD4KPC9ib2R5Pgo8L2h0bWw+Cg==";

    const introFrame = document.getElementById('introFrame');
    const mainFrame  = document.getElementById('mainFrame');

    introFrame.src = "data:text/html;base64," + INTRO_B64;
    mainFrame.src  = "data:text/html;base64," + MAIN_B64;

    const INTRO_MS = 10000;      // 10 seconds
    const FX_MS    = 1200;       // optical effect duration

    function switchToMain(){
      // optical effect burst
      document.body.classList.add('fx-on');

      // after fx finishes, reveal main
      setTimeout(() => {
        document.body.classList.add('main-on');

        // cleanup intro to free resources (optional)
        setTimeout(() => {
          try { introFrame.src = "about:blank"; } catch(e){}
        }, 900);
      }, Math.min(900, FX_MS - 200));

      setTimeout(() => {
        document.body.classList.remove('fx-on');
      }, FX_MS);
    }

    // start gate (mobile-friendly): on touch devices we wait for a tap to unlock media/timers.
    const isTouch = matchMedia('(pointer:coarse)').matches || 'ontouchstart' in window;
    const overlay = document.getElementById('startOverlay');

    let started = false;
    let introTimer = null;

    function begin(){
      if (started) return;
      started = true;
      if (overlay) overlay.classList.add('hidden');
      // auto switch after 10s (from *start*)
      introTimer = setTimeout(switchToMain, INTRO_MS);
    }

    if (isTouch && overlay){
      // require a tap (helps iOS autoplay restrictions)
      const tap = () => begin();
      overlay.addEventListener('click', tap, { once:true });
      overlay.addEventListener('touchstart', tap, { once:true, passive:true });
      overlay.addEventListener('keydown', (e) => { if(e.key==='Enter' || e.key===' ') begin(); }, { once:true });
    } else {
      // desktop: start immediately
      begin();
    }
    // optional: click anywhere to skip intro instantly
    function skipNow(){
      if (!started) begin();
      if (document.body.classList.contains('main-on')) return;
      try{ if (introTimer) clearTimeout(introTimer); }catch(e){}
      switchToMain();
    }

    // tap anywhere (outside overlay) to skip intro instantly
    window.addEventListener('pointerdown', (e) => { if (overlay && !overlay.classList.contains('hidden')) return; skipNow(); }, { once:true });
    window.addEventListener('touchstart', (e) => { if (overlay && !overlay.classList.contains('hidden')) return; skipNow(); }, { once:true, passive:true });
    window.addEventListener('click', (e) => { if (overlay && !overlay.classList.contains('hidden')) return; skipNow(); }, { once:true });
  </script>
</body>
</html>
