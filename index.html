<!DOCTYPE html>
<html lang="el">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>EUPHORIA – Multi‑User Neon Board (Hi‑Tech Buttons)</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&family=Orbitron:wght@700&display=swap');

    :root{
      --bg1:#221737; --bg2:#2a2048; --bg3:#18122b;
      --bg-pink:#ff41c4; --bg-cyan:#45caff;

      --neon1:#ff7ae1; --neon2:#8b78ff; --neon3:#ffd1ff;

      --surface:#262e6aee; --surface-2:#33408b99; --outline:#9bc2ff3d; --dashed:#a8c6ff33;
      --text:#ffffff; --muted:#c9d2ff;

      --btn-save-from:#44fcb3; --btn-save-to:#00d6a6;
      --btn-clear-from:#ff85da; --btn-clear-to:#ffa7f1;

      --glow-blue:#6ab8ff66; --glow-pink:#ff7ae166;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family:'Poppins',system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; color:var(--text);
      background:
        radial-gradient(1200px 800px at 12% 0%, rgba(255,65,196,.28) 0%, transparent 60%),
        radial-gradient(1100px 700px at 90% 110%, rgba(69,202,255,.26) 0%, transparent 60%),
        linear-gradient(135deg,var(--bg1),var(--bg2) 45%,var(--bg3));
      background-attachment: fixed;
    }

    .wrapper{ padding: clamp(20px,3vw,40px); max-width:1600px; margin-inline:auto; }

    .brand{ text-align:center; margin:8px auto 26px; }
    .brand h1{
      text-transform:uppercase; font-family:'Orbitron',sans-serif; font-weight:700; letter-spacing:.1em;
      font-size: clamp(28px, 4.6vw, 50px); margin:0; line-height:1.05;
      background: linear-gradient(90deg,var(--neon2),var(--neon1),var(--neon3));
      -webkit-background-clip:text; background-clip:text; color:transparent;
      filter: drop-shadow(0 0 8px var(--glow-pink)) drop-shadow(0 0 10px var(--glow-blue));
      animation: headerPulse 10s ease-in-out infinite;
    }
    .brand .sub{ margin-top:8px; font-weight:500; font-size:clamp(12px,1.6vw,15px); color:var(--muted); letter-spacing:.18em; text-transform:uppercase; opacity:.9; }

    /* Toolbar (inside apps) */
    .toolbar{ display:flex; gap:10px; justify-content:center; align-items:center; margin:18px auto 16px; }
    .btn{ appearance:none; border:none; cursor:pointer; font-weight:600; letter-spacing:.06em; text-transform:uppercase; font-size:12px; color:#0b0f1a; padding:10px 18px; border-radius:999px; box-shadow:0 10px 26px -12px var(--glow-blue), 0 0 16px -8px var(--glow-pink); transition: transform .12s ease, filter .2s ease; position:relative; overflow:hidden; }
    #saveAll{ background: linear-gradient(135deg, var(--btn-save-from), var(--btn-save-to)); }
    #clearAll{ background: linear-gradient(135deg, var(--btn-clear-from), var(--btn-clear-to)); }
    .btn:hover{ transform: translateY(-1px); filter:brightness(1.06); }
    .btn.ghost{ background:transparent; color:#e3e8ff; border:1px solid #9bbcff44; box-shadow:none; }

    /* Grid 5x2 */
    .grid{ display:grid; grid-template-columns: repeat(5,1fr); gap:clamp(16px,1.6vw,20px); }
    @media (max-width:1300px){ .grid{ grid-template-columns: repeat(4,1fr);} }
    @media (max-width:1000px){ .grid{ grid-template-columns: repeat(3,1fr);} }
    @media (max-width:760px){ .grid{ grid-template-columns: repeat(2,1fr);} }
    @media (max-width:520px){ .grid{ grid-template-columns: 1fr;} }

    /* Capsules */
    .capsule{ position:relative; border-radius:22px; padding:20px 16px 16px; background: linear-gradient(165deg, rgba(38,46,106,.9), rgba(255,255,255,.02)); backdrop-filter: blur(10px) saturate(130%); border:1px solid var(--outline); box-shadow:0 20px 40px -28px #000a, 0 0 30px -18px var(--glow-blue), inset 0 0 .5px rgba(255,255,255,.35); opacity:0; transform: translateY(12px) scale(.99); animation: buildIn .6s cubic-bezier(.2,.7,.2,1) var(--delay,0s) forwards; }
    .cap-title{ text-align:center; font-family:'Poppins',sans-serif; font-weight:700; text-transform:uppercase; letter-spacing:.06em; font-size:clamp(13px,1.3vw,15px); padding:10px 12px; border-radius:14px; background: linear-gradient(180deg, rgba(51,64,139,.8), rgba(51,64,139,.6)); color:#fff; border:1px solid var(--outline); box-shadow: 0 0 16px var(--glow-blue), 0 0 24px var(--glow-pink); text-shadow:0 0 6px #ffffffaa; }
    .cap-body{ margin-top:12px; background:#2a3588cc; border:1px dashed var(--dashed); border-radius:16px; padding:10px 10px 8px 14px; min-height:220px; }
    ol.rank{ margin:0; padding:0 0 8px 1.4em; list-style:decimal; color:#dfe7ff; }
    .rank li{ margin:5px 0 9px 0; line-height:1.55; }
    .editable{ display:block; padding:6px 10px; border-radius:10px; outline:none; border:1px solid transparent; background:#2b337a80; transition: border .15s ease, background .15s ease, box-shadow .15s ease; min-height:26px; color:#f0f4ff; }
    .editable:focus{ border-color:#7bb8ff; background:#3340a1b3; box-shadow:0 0 0 3px #7bb8ff33; }
    .editable:empty:before{ content:attr(data-placeholder); color:#b7c8ff; opacity:.75; }

    /* Landing (login) */
    .landing{ display:grid; place-items:center; gap:22px; margin-top:26px; }
    .login-grid{ display:grid; grid-template-columns: repeat(3,minmax(0,280px)); gap:18px; }
    @media (max-width:980px){ .login-grid{ grid-template-columns:1fr; } }

    
/* --- Modern User Buttons v2 (bigger, glassy, neon, flowing light) --- */
.login-btn{
  --btn-grad: linear-gradient(135deg, #8b78ff, #ff7ae1, #00eaff);
  --btn-bg: rgba(30,36,90,0.42);
  position:relative;
  padding: 26px 34px;
  border-radius: 22px;
  border: 1px solid #a8bfff66;
  background: var(--btn-bg);
  color:#fff;
  font-weight: 800;
  font-size: 1.12rem;
  letter-spacing:.08em;
  text-transform: uppercase;
  box-shadow:
    0 10px 30px -18px rgba(0,0,0,.7),
    0 0 30px -12px #ff7ae166,
    0 0 36px -16px #6ab8ff66,
    inset 0 0 6px rgba(255,255,255,0.2);
  cursor:pointer;
  overflow:hidden; isolation:isolate;
  transition:
    transform .25s ease,
    box-shadow .3s ease,
    border-color .3s ease,
    background .3s ease;
  backdrop-filter: blur(10px) saturate(130%);
  opacity:0; transform: translateY(12px) scale(.97);
  animation: popIn .7s cubic-bezier(.2,.7,.2,1) forwards;
  animation-delay: var(--d,0s);
}

.login-btn:hover{
  transform: translateY(-4px) scale(1.03);
  border-color:#ffffffaa;
  box-shadow:
    0 16px 40px -18px rgba(0,0,0,.7),
    0 0 36px #ff7ae1aa,
    0 0 46px #45caff99,
    inset 0 0 10px rgba(255,255,255,0.28);
}

.login-btn:active{
  transform: translateY(0) scale(.98);
  box-shadow:
    0 10px 24px -18px rgba(0,0,0,.7),
    0 0 22px #ff7ae188,
    0 0 28px #45caff77,
    inset 0 0 8px rgba(255,255,255,0.25);
}

/* Outer neon glow */
.login-btn::before{
  content:"";
  position:absolute; inset:-1px; border-radius:inherit;
  background: var(--btn-grad);
  filter: blur(12px);
  opacity:.55;
  transition: opacity .25s ease;
  z-index:-1;
}

/* Flowing light sweep */
.login-btn::after{
  content:"";
  position:absolute; inset:0; border-radius:inherit;
  background: linear-gradient(120deg, transparent 0 45%, rgba(255,255,255,.45) 50%, transparent 55%);
  transform: translateX(-160%) skewX(-20deg);
  animation: btnShine 3.8s ease-in-out infinite;
  mix-blend-mode: screen; pointer-events:none;
}

.login-btn:hover::before{ opacity:.9; }
.login-btn:hover::after{ animation-duration: 2.4s; }

@keyframes btnShine{
  0% { transform: translateX(-160%) skewX(-20deg); }
  60% { transform: translateX(160%) skewX(-20deg); }
  100% { transform: translateX(160%) skewX(-20deg); }
}


    /* button ripple */
    .ripple{
      position:absolute; width:12px; height:12px; border-radius:50%;
      background: radial-gradient(circle, rgba(255,255,255,.8) 0%, rgba(255,255,255,.0) 60%);
      transform: translate(-50%,-50%); animation: ripple 700ms ease-out forwards; pointer-events:none;
      filter: blur(1px);
    }

    /* Entrance sequencing */
    .login-main{ grid-column:1 / -1; width:min(440px, 92vw); justify-self:center; }

    .hidden{ display:none !important; }

    /* Admin table */
    table{ width:100%; border-collapse:separate; border-spacing:0; }
    th,td{ padding:10px 12px; text-align:center; }
    thead th{ background:#2f3988aa; color:#fff; font-weight:700; position:sticky; top:0; }
    tbody td{ background:#24307baa; color:#e7ecff; }
    tbody tr + tr td{ border-top:1px solid #9bbcff2b; }
    .stat-card{ background: linear-gradient(165deg,#2a347dcc,#232b69cc); border:1px solid #9bbcff2d; border-radius:16px; padding:14px 16px; margin:10px 0; }

    /* Animations */
    @keyframes headerPulse{ 0%,100%{ filter: drop-shadow(0 0 8px var(--glow-pink)) drop-shadow(0 0 10px var(--glow-blue)); } 50%{ filter: drop-shadow(0 0 12px var(--glow-pink)) drop-shadow(0 0 14px var(--glow-blue)); } }
    @keyframes buildIn{ to{ opacity:1; transform: translateY(0) scale(1);} }
    @keyframes popIn{ to{ opacity:1; transform: translateY(0) scale(1);} }
    @keyframes ripple{ from{ width:0; height:0; opacity:.6; } to{ width:260px; height:260px; opacity:0; } }
  
/* --- Enhanced Neon Intro --- */
#intro {
  position: fixed;
  inset: 0;
  background: radial-gradient(circle at 50% 50%, #1a1330 0%, #0d081a 90%);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 9999;
  overflow: hidden;
  animation: fadeOut 1.2s ease forwards;
  animation-delay: 6s;
}

.intro-text {
  font-family: 'Orbitron', sans-serif;
  font-size: clamp(44px, 7vw, 100px);
  letter-spacing: 0.18em;
  color: #ffffff;
  position: relative;
  text-shadow:
    0 0 12px #ff00e6,
    0 0 24px #ff00e6,
    0 0 36px #00caff,
    0 0 52px #00caff;
  white-space: nowrap;
}

/* Per-letter build */
.intro-text .char {
  opacity: 0;
  display: inline-block;
  filter: blur(8px);
  transform: translateY(10px) scale(0.98);
  animation: charOn 0.6s ease forwards;
  animation-delay: calc(var(--i) * 0.08s);
}

@keyframes charOn {
  0% { opacity: 0; filter: blur(8px); transform: translateY(12px) scale(0.98); }
  60% { opacity: 1; filter: blur(2px); transform: translateY(0) scale(1); }
  100% { opacity: 1; filter: blur(0); transform: translateY(0) scale(1); }
}

/* Flicker pulse and shine sweep */


/* Shine sweep */

  60% { left: 120%; }
  100% { left: 120%; }
}

/* Pulse glow (starts after all letters appear) */
@keyframes pulseGlow {
  0% { text-shadow: 0 0 10px #ff00e6, 0 0 20px #ff00e6, 0 0 30px #00caff; }
  50% { text-shadow: 0 0 20px #ff00e6, 0 0 40px #00caff, 0 0 60px #00caff; }
  100% { text-shadow: 0 0 12px #ff00e6, 0 0 24px #00caff, 0 0 48px #00caff; }
}

@keyframes fadeOut {
  to { opacity: 0; visibility: hidden; }
}


/* --- Admin details accordion --- */
.details-panel{
  border:1px solid var(--outline);
  border-radius:14px;
  margin:10px 0;
  background: linear-gradient(165deg,#2a347dcc,#232b69cc);
}
.details-head{
  display:flex; align-items:center; justify-content:space-between;
  gap:10px; padding:12px 14px; cursor:pointer;
  user-select:none;
}
.details-head h5{
  margin:0; font-size:14px; letter-spacing:.06em; text-transform:uppercase;
}
.details-toggle{
  width:22px; height:22px; display:grid; place-items:center;
  border-radius:6px; border:1px solid #9bbcff55; font-weight:800;
}
.details-body{
  display:none; padding:12px 14px 16px; border-top:1px solid #9bbcff2d;
}
.details-body.open{ display:block; }
.detail-grid{
  display:grid; grid-template-columns:repeat(3,1fr); gap:12px;
}
@media (max-width:900px){ .detail-grid{ grid-template-columns:1fr; } }
.detail-col{
  background:#24307baa; border:1px dashed var(--dashed);
  border-radius:12px; padding:10px 12px;
}
.detail-col h6{
  margin:0 0 8px; font-size:12px; letter-spacing:.08em; text-transform:uppercase; color:#d9e2ff;
}
.detail-col ol{ margin:0; padding-left:1.2em; }
.detail-col li{ margin:4px 0 6px; color:#f1f4ff; line-height:1.45; word-break:break-word; }
.detail-empty{ color:#aebdf3; font-style:italic; }

</style>
</head>
<body>
  <div id="intro">
    <h1 class="intro-text">EUPHORIA</h1>
  </div>
  <div class="wrapper">
    <div class="brand">
      <h1>EUPHORIA</h1>
      <div class="sub">ONLINE MUSIC AWARDS 2026</div>
    </div>

    <!-- Landing screen -->
    <section id="landing" class="landing">
      <button class="login-btn login-main" data-user="james" data-pass="0825" style="--d:.05s">James Rigas</button>
      <div class="login-grid">
        <button class="login-btn" data-user="teri" data-pass="1478" style="--d:.15s">Teri Vi Sentio</button>
        <button class="login-btn" data-user="monhia" data-pass="9632" style="--d:.25s">Monhia</button>
        <button class="login-btn" data-user="lijiansi" data-pass="2365" style="--d:.35s">Lijiansi</button>
      </div>
    </section>

    <!-- App for regular users -->
    <section id="app" class="hidden">
      <div class="toolbar">
        <button class="btn" id="saveAll">Αποθήκευση</button>
        <button class="btn" id="clearAll">Καθαρισμός</button>
        <button class="btn ghost" id="logout">Έξοδος</button>
      </div>
      <h3 id="userLabel" style="text-align:center; margin-top:0; color:#d9e2ff; letter-spacing:.1em; text-transform:uppercase;"></h3>
      <section class="grid" id="grid"></section>
    </section>

    <!-- Admin dashboard for James -->
    <section id="admin" class="hidden">
      <div class="toolbar">
        <button class="btn ghost" id="backToLanding">Έξοδος</button>
        <button class="btn" id="exportExcel">Λήψη Excel</button>
      </div>
      <h3 style="text-align:center; margin-top:0; color:#d9e2ff; letter-spacing:.1em; text-transform:uppercase;">Συγκεντρωτικά Στατιστικά</h3>
      <div id="statSummary" class="stat-card"></div>
      <div class="stat-card">
        <table id="statTable">
          <thead>
            <tr>
              <th>Κατηγορία</th>
              <th>Teri Vi Sentio</th>
              <th>Monhia</th>
              <th>Lijiansi</th>
              <th>Σύνολο Συμπληρωμένων (0–10)</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    
    <div class="stat-card" id="adminDetails" style="margin-top:14px;">
      <h4 style="margin:8px 0 12px; text-align:center; letter-spacing:.08em; text-transform:uppercase; color:#e8eeff;">Αναλυτική Προβολή Καταχωρήσεων</h4>
      <div id="detailsAccordion"></div>
    </div>
    </section>
  </div>

  <script>
    const USERS = {
      james: {label:'James Rigas', pass:'0825', admin:true, prefix:'u_james'},
      teri: {label:'Teri Vi Sentio', pass:'1478', admin:false, prefix:'u_teri'},
      monhia: {label:'Monhia', pass:'9632', admin:false, prefix:'u_monhia'},
      lijiansi: {label:'Lijiansi', pass:'2365', admin:false, prefix:'u_lijiansi'},
    };
    const TITLES = [
      'BEST GREEK SONG',
      'BEST FOREIGN SONG',
      'BEST GREEK MALE ARTIST',
      'BEST FOREIGN MALE ARTIST',
      'BEST GREEK FEMALE ARTIST',
      'BEST FOREIGN FEMALE ARTIST',
      'BEST GREEK MUSIC VIDEO',
      'BEST FOREIGN MUSIC VIDEO',
      'BEST ESC 25 PERFORMANCE',
      'ALBUM OF THE YEAR'
    ];

    const landing = document.getElementById('landing');
    const app = document.getElementById('app');
    const admin = document.getElementById('admin');
    const grid = document.getElementById('grid');
    const userLabel = document.getElementById('userLabel');

    function keyFor(prefix, catIdx){ return `${prefix}_capsule_${catIdx}`; }
    function createCapsule(title, idx, prefix){
      const items = Array.from({length:10}, ()=> '<li><div class="editable" contenteditable data-placeholder="Γράψε εδώ..."></div></li>').join('');
      const card = document.createElement('article');
      card.className = 'capsule';
      card.dataset.key = keyFor(prefix, idx);
      card.style.setProperty('--delay', (idx * 0.08) + 's');
      card.innerHTML = '<div class="cap-title">'+title+'</div><div class="cap-body"><ol class="rank">'+items+'</ol></div>';
      return card;
    }
    function saveCard(card){
      const key = card.dataset.key;
      const items = [...card.querySelectorAll('.editable')].map(el=>el.innerHTML.trim());
      localStorage.setItem(key, JSON.stringify(items));
    }
    function loadCard(card){
      const key = card.dataset.key;
      let saved = localStorage.getItem(key);
      if(!saved) return;
      try{
        saved = JSON.parse(saved);
        const rows = card.querySelectorAll('.editable');
        saved.forEach((v,i)=>{ if(rows[i]) rows[i].innerHTML = v; });
      }catch(e){ console.warn('cannot parse saved card', key); }
    }
    function renderApp(userKey){
      app.classList.remove('hidden');
      admin.classList.add('hidden');
      grid.innerHTML = '';
      userLabel.textContent = 'Χρήστης: '+USERS[userKey].label;
      TITLES.forEach((t,i)=> grid.appendChild(createCapsule(t,i,USERS[userKey].prefix)));
      requestAnimationFrame(()=>{ document.querySelectorAll('.capsule').forEach(loadCard); });
      app.oninput = (e)=>{ const cap = e.target.closest('.capsule'); if(cap) saveCard(cap); };
      document.getElementById('saveAll').onclick = ()=>{ document.querySelectorAll('.capsule').forEach(saveCard); alert('Αποθηκεύτηκαν οι καταχωρήσεις σας.'); };
      document.getElementById('clearAll').onclick = ()=>{
        if(!confirm('Να διαγραφούν όλα τα πεδία;')) return;
        document.querySelectorAll('.capsule').forEach(card=>{
          [...card.querySelectorAll('.editable')].forEach(el=> el.textContent='');
          localStorage.removeItem(card.dataset.key);
        });
      };
      document.getElementById('logout').onclick = ()=>{ app.classList.add('hidden'); landing.classList.remove('hidden'); };
    }
    function countFilled(arr){ return arr.filter(v=> v && v.replace(/<br\s*\/?>/g,'').replace(/&nbsp;/g,'').trim().length>0).length; }
    function getUserData(prefix){
      const perCategory = [];
      for(let i=0;i<TITLES.length;i++){
        const key = keyFor(prefix, i);
        let saved = localStorage.getItem(key);
        let count = 0;
        if(saved){ try{ const arr = JSON.parse(saved); count = countFilled(arr);}catch(_){} }
        perCategory.push(count);
      }
      return perCategory;
    }
    
// --- Helpers to get raw text safely (strip HTML) ---
function cleanText(htmlStr){
  if(!htmlStr) return '';
  const tmp = document.createElement('div');
  tmp.innerHTML = htmlStr;
  // convert <br> to newline for readability
  tmp.querySelectorAll('br').forEach(br => br.replaceWith('\n'));
  const text = tmp.textContent || '';
  return text.replace(/\u00A0/g, ' ').trim();
}

function getUserItems(prefix, catIdx){
  const key = keyFor(prefix, catIdx);
  let saved = localStorage.getItem(key);
  const items = Array.from({length:10}, ()=>'');
  if(saved){
    try{
      const arr = JSON.parse(saved);
      for(let i=0;i<Math.min(arr.length,10);i++){
        items[i] = cleanText(arr[i]);
      }
    }catch(e){ /* ignore */ }
  }
  return items;
}

function makeDetailColumn(title, items){
  const col = document.createElement('div');
  col.className = 'detail-col';
  col.innerHTML = '<h6>'+title+'</h6>';
  const hasAny = items.some(v => v && v.length);
  if(!hasAny){
    const p = document.createElement('p');
    p.className = 'detail-empty';
    p.textContent = 'Καμία καταχώριση.';
    col.appendChild(p);
    return col;
  }
  const ol = document.createElement('ol');
  items.forEach(v => {
    const li = document.createElement('li');
    li.textContent = v && v.length ? v : '—';
    ol.appendChild(li);
  });
  col.appendChild(ol);
  return col;
}

function renderAdminDetails(){
  const acc = document.getElementById('detailsAccordion');
  if(!acc) return;
  acc.innerHTML = '';
  const uKeys = ['teri','monhia','lijiansi'];
  TITLES.forEach((catTitle, idx) => {
    const panel = document.createElement('div');
    panel.className = 'details-panel';
    const head = document.createElement('div');
    head.className = 'details-head';
    head.innerHTML = '<h5>'+catTitle+'</h5><div class="details-toggle">+</div>';
    const body = document.createElement('div');
    body.className = 'details-body';
    const grid = document.createElement('div');
    grid.className = 'detail-grid';

    const teriItems = getUserItems(USERS['teri'].prefix, idx);
    const monhiaItems = getUserItems(USERS['monhia'].prefix, idx);
    const lijItems = getUserItems(USERS['lijiansi'].prefix, idx);

    grid.appendChild(makeDetailColumn('Teri Vi Sentio', teriItems));
    grid.appendChild(makeDetailColumn('Monhia', monhiaItems));
    grid.appendChild(makeDetailColumn('Lijiansi', lijItems));

    body.appendChild(grid);
    panel.appendChild(head);
    panel.appendChild(body);
    acc.appendChild(panel);

    head.addEventListener('click', ()=>{
      const open = body.classList.toggle('open');
      head.querySelector('.details-toggle').textContent = open ? '–' : '+';
    });
  });
}


// === Excel Export (HTML-based .xls) ===
function buildExportHTML(){
  // Summary table
  const uKeys = ['teri','monhia','lijiansi'];
  let summaryRows = '';
  for(let i=0;i<TITLES.length;i++){
    const counts = uKeys.map(k=> getUserData(USERS[k].prefix)[i]);
    summaryRows += '<tr>'
      + '<td>' + TITLES[i] + '</td>'
      + '<td>' + counts[0] + '</td>'
      + '<td>' + counts[1] + '</td>'
      + '<td>' + counts[2] + '</td>'
      + '<td>' + (counts[0]+counts[1]+counts[2]) + '</td>'
      + '</tr>';
  }
  const summaryTable = '<table border="1">'
    + '<thead><tr><th>Κατηγορία</th><th>Teri Vi Sentio</th><th>Monhia</th><th>Lijiansi</th><th>Σύνολο</th></tr></thead>'
    + '<tbody>' + summaryRows + '</tbody></table>';

  // Detailed table (one big table)
  let detailHTML = '<table border="1">'
    + '<thead><tr><th>Κατηγορία</th><th>Θέση</th><th>Teri Vi Sentio</th><th>Monhia</th><th>Lijiansi</th></tr></thead><tbody>';
  for(let i=0;i<TITLES.length;i++){
    const teri = getUserItems(USERS['teri'].prefix, i);
    const monh = getUserItems(USERS['monhia'].prefix, i);
    const lij = getUserItems(USERS['lijiansi'].prefix, i);
    for(let pos=0; pos<10; pos++){
      const cat = (pos===0) ? TITLES[i] : '';
      detailHTML += '<tr>'
        + '<td>' + cat + '</td>'
        + '<td>' + (pos+1) + '</td>'
        + '<td>' + (teri[pos] || '') + '</td>'
        + '<td>' + (monh[pos] || '') + '</td>'
        + '<td>' + (lij[pos] || '') + '</td>'
        + '</tr>';
    }
  }
  detailHTML += '</tbody></table>';

  const html = '<html><head><meta charset="UTF-8"><style>table{border-collapse:collapse;font-family:Arial, sans-serif}th,td{padding:6px 8px}th{background:#eef}td{vertical-align:top;}</style></head><body>'
    + '<h2>Συγκεντρωτικά Στατιστικά</h2>' + summaryTable
    + '<h2 style="margin-top:24px;">Αναλυτικές Καταχωρήσεις (1–10)</h2>' + detailHTML
    + '</body></html>';
  return html;
}

function exportToExcel(){
  const content = buildExportHTML();
  const blob = new Blob([content], {type: 'application/vnd.ms-excel'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  const dt = new Date();
  const pad = (n)=> String(n).padStart(2,'0');
  const fname = 'EUPHORIA_export_' + dt.getFullYear() + '-' + pad(dt.getMonth()+1) + '-' + pad(dt.getDate()) + '.xls';
  a.href = url;
  a.download = fname;
  document.body.appendChild(a);
  a.click();
  setTimeout(()=>{
    URL.revokeObjectURL(url);
    a.remove();
  }, 0);
}

function renderAdmin(){
      app.classList.add('hidden'); admin.classList.remove('hidden');
      const uKeys = ['teri','monhia','lijiansi'];
      const tBody = admin.querySelector('#statTable tbody'); tBody.innerHTML = '';
      let totals = {teri:0, monhia:0, lijiansi:0};
      for(let i=0;i<TITLES.length;i++){
        const counts = uKeys.map(k=> getUserData(USERS[k].prefix)[i]);
        totals.teri += counts[0]; totals.monhia += counts[1]; totals.lijiansi += counts[2];
        const tr = document.createElement('tr');
        tr.innerHTML = '<td style="text-align:left;">'+TITLES[i]+'</td><td>'+counts[0]+'</td><td>'+counts[1]+'</td><td>'+counts[2]+'</td><td>'+counts.reduce((a,b)=>a+b,0)+'</td>';
        tBody.appendChild(tr);
      }
      const sum = totals.teri + totals.monhia + totals.lijiansi;
      const summary = admin.querySelector('#statSummary');
      summary.innerHTML = '<strong>Σύνολο συμπληρωμένων γραμμών:</strong> '+sum+' / '+(TITLES.length*10*3)+'<br><small>Teri Vi Sentio: '+totals.teri+' • Monhia: '+totals.monhia+' • Lijiansi: '+totals.lijiansi+'</small>';
      renderAdminDetails();
      const btn = document.getElementById('exportExcel'); if(btn){ btn.onclick = exportToExcel; } 
      renderAdminDetails();
      document.getElementById('backToLanding').onclick = ()=>{ admin.classList.add('hidden'); landing.classList.remove('hidden'); };
    }
    function askPasswordAndEnter(userKey, requiredPass){
      const input = prompt('Δώσε κωδικό πρόσβασης:');
      if(input === null) return;
      if(input === requiredPass){ landing.classList.add('hidden'); if(USERS[userKey].admin){ renderAdmin(); } else { renderApp(userKey); } }
      else{ alert('Λάθος κωδικός.'); }
    }
    landing.addEventListener('click', (e)=>{
      const btn = e.target.closest('.login-btn'); if(!btn) return;
      // Ripple
      const r = document.createElement('span'); r.className='ripple';
      const rect = btn.getBoundingClientRect();
      r.style.left = (e.clientX - rect.left)+'px'; r.style.top = (e.clientY - rect.top)+'px';
      btn.appendChild(r); setTimeout(()=>r.remove(), 700);
      // Auth
      askPasswordAndEnter(btn.dataset.user, btn.dataset.pass);
    });
  


// Split intro text into per-letter spans with staggered animation
(function(){
  const el = document.querySelector('#intro .intro-text');
  if (!el) return;
  const text = el.textContent.trim();
  el.textContent = '';
  for (let i = 0; i < text.length; i++) {
    const span = document.createElement('span');
    span.className = 'char';
    span.style.setProperty('--i', i);
    span.textContent = text[i];
    el.appendChild(span);
  }
  // After letters finish (~ text.length * 80ms + 600ms), enable subtle pulse
  const total = text.length * 80 + 600;
  setTimeout(() => {
    el.style.animation = 'pulseGlow 2s ease-in-out infinite alternate';
  }, total);
})();

// Hide intro after 6 seconds
window.addEventListener('load', () => {
  setTimeout(() => {
    const intro = document.getElementById('intro');
    if (intro) intro.style.display = 'none';
  }, 6500);
});

</script>
  <!-- Firebase SDKs (χωρίς import, τρέχει απευθείας στον browser) -->
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>

<script>
  // === Firebase configuration ===
  const firebaseConfig = {
  apiKey: "AIzaSyA3j74FN_DIrsZclq09lIY62eenSOzP0yQ",
  authDomain: "euphoria-2026.firebaseapp.com",
  projectId: "euphoria-2026",
  storageBucket: "euphoria-2026.firebasestorage.app",
  messagingSenderId: "259023927428",
  appId: "1:259023927428:web:74099e69bea7b07a7b2ad1",
  measurementId: "G-JEVRCV89WB"
};

  // === Initialize Firebase ===
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();
  firebase.auth().signInAnonymously();
</script>

</body>
</html>
